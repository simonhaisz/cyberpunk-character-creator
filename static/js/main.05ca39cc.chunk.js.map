{"version":3,"sources":["model/character.ts","data/default-character.ts","persistance.ts","model/meta-type.ts","model/attributes.ts","model/skills.ts","model/dictionary.ts","model/quality.ts","model/gear.ts","model/karma.ts","reducer.ts","context.ts","component/CharacterName.tsx","component/SelectCharacter.tsx","data/meta-types.ts","component/ChipCollection.tsx","model/item.ts","component/GradeButton.tsx","component/ItemPickerCard.tsx","component/ItemPickerSection.tsx","component/ItemPickerDialog.tsx","component/ItemPickerButton.tsx","component/GroupContainer.tsx","component/QualitiesSection.tsx","component/CharacterTab.tsx","model/custom-item.ts","component/PickerDialog.tsx","component/PickerButton.tsx","component/Property.tsx","component/Skill.tsx","component/SkillList.tsx","component/ActiveSkillList.tsx","component/KnowledgeSkillList.tsx","component/LanguageSkillList.tsx","component/SkillsTab.tsx","component/Karma.tsx","component/Attribute.tsx","component/AttributeList.tsx","component/AttributesTab.tsx","model/contact.ts","component/Contact.tsx","component/ContactList.tsx","component/ContactsTab.tsx","component/MagicTab.tsx","component/GearTab.tsx","model/magic.ts","component/ReadOnlyProperty.tsx","component/CombatTab.tsx","component/CharacterCreator.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["MetaType","isAwakened","character","undefined","qualities","find","q","name","DEFAULT_KEY","DEFAULT_CHARACTER","key","streetName","metaType","Human","attributes","rating","activeSkills","knowledgeSkills","languageSkills","contacts","spells","gear","getDefaultCharacter","CHARACTER_KEY","createCharacterKey","loadCharacter","localStorage","getItem","JSON","parse","SELECTED_CHARACTER_KEY","CUSTOM_ITEM_KEY","createCustomItemKey","path","getMetaTypeCost","Ork","Dwarf","Elf","Troll","Error","getEffectiveAttributeRating","attribute","a","getAttributeModifier","getAttributeCost","getAttributesCost","awakened","cost","getActiveSkillCost","getActiveSkillsCost","map","s","reduce","b","getKnowledgeSkillCost","getKnowledgeSkillsCost","getFreeKnowledgeSkillPoints","intuition","logic","getSkillsCost","activeSkillCost","knowledgeSkillCost","languageSkillCost","freeKnowledgePoints","Math","max","transformAllItems","parentPath","parentData","allItems","transformValues","Object","keys","childName","childPath","childData","isArray","itemCostMap","Map","getItemCost","item","has","get","items","foundItem","g","stringify","parseInt","set","itemAvailabilityMap","getChildSet","values","subset","findChildPaths","childPaths","parents","split","components","length","match","i","push","qualitiesRoot","transformQualityValues","value","getCharacterQualitiesCost","allQualities","Grade","gearRoot","transformGearValues","v","data","availability","costLabel","propName","propValue","transformGearItem","test","splitGearItems","finalizeGearItem","itemVersions","groupResult","exec","namePrefix","nameSuffixes","r","trim","itemCount","itemVersion","splitValues","costResult","isNaN","computeItemCost","allGear","grade","Alpha","Used","Beta","Delta","getGradeCostMultipler","parseAvailability","legality","Number","NaN","getAvailabilityCostMultiplier","getItemAvailability","createSavedItem","count","savedItem","result","console","error","getCharacterGearNuyenCost","nuyen","getCharacterGearKarmaCost","ceil","ActionType","STARTING_KARMA","getDefaultKarma","total","spent","available","getCharacterKarma","karma","state","reducer","action","type","UpdateCharacter","selectedCharacter","SaveCharacter","isDefaultCharacter","Date","now","characters","setItem","saveCharacter","ClearCharacter","removeItem","clearCharacter","filter","c","SelectCharacter","characterRef","LoadQualities","LoadSkills","allSkills","LoadContacts","allContacts","LoadGear","LoadSpells","allSpells","LoadCustomItems","customItems","AddCustomItem","newItem","Name","saveCustomItem","INITIAL_STATE","positive","negative","active","knowledge","language","combat","detection","health","illusion","manipulation","DispatchContext","createContext","useDispatch","useContext","StateContext","useGlobalState","property","CharacterName","props","Typography","dispatch","List","subheader","ListSubheader","ListItem","onClick","onCharacterClick","ALL_META_TYPES","useStyles","makeStyles","root","display","flexDirection","flexWrap","justifyContent","chip","marginRight","marginBottom","ChipCollection","createChipLabel","onDeleteValue","classes","className","Badge","badgeContent","invisible","color","anchorOrigin","vertical","horizontal","Chip","label","onDelete","getItemSubset","subItems","startsWith","minWidth","maxWidth","width","GradeButton","disabled","onUpdateGrade","Button","variant","nextGrade","padding","margin","textAlign","ItemPickerCard","createCostLabel","onUpdateItem","hasAny","allowMultiple","includeAvailability","isItemAvailable","includeGrade","Paper","elevation","style","lineHeight","ButtonGroup","toString","newGrade","ItemPickerSection","onUpdateItems","handleUpdate","newItems","findIndex","Divider","ItemPickerDialog","open","onClose","title","onUpdateAllItems","allPaths","paths","pathToLabel","finalComponent","sentenceCase","useState","group","setGroup","p","Dialog","DialogTitle","DialogContent","Select","id","displayEmpty","onChange","event","target","MenuItem","newAllItems","ItemPickerButton","setOpen","parentPathsToName","componentIndex","parentPathToName","differenceFound","pathIndex","slice","join","getNextParentPaths","parentPaths","setParentPath","menuAnchor","setMenuAnchor","allChildItems","allCountedItems","hasItems","localItems","matchingItems","localItem","matchingItem","IconButton","currentTarget","size","disableRipple","anchorEl","Boolean","handleMenuClick","newCountedItems","includeItem","index","splice","headerLabel","fontWeight","GroupContainer","createItemLabel","createItemCostLabel","flatItems","ExpansionPanel","defaultExpanded","ExpansionPanelSummary","expandIcon","FormControlLabel","stopPropagation","onFocus","control","ExpansionPanelDetails","toDelete","QualitiesSection","createQualityCostLabel","newQualities","header","marginLeft","field","marginTop","divider","CharacterTab","onCharacterUpdated","updatedCharacter","TextField","id-","e","t","getChildItems","content","ul","PickerDialog","onItemSelectionChange","includeCost","allowNewItems","allowMultiSelection","newItemName","setNewItemName","newItemAvailability","setNewItemAvailability","newItemCost","setNewItemCost","onUpdateNewItem","aria-label","selected","Availability","Cost","ListItemText","findName","editButton","paddingLeft","PickerButton","breadcrums","selectedValueNames","addValue","removeValue","allowNewValues","createValue","findAvailability","findCost","n","createSelectableItem","height","slider","Property","onUpdate","min","step","formatDisplayValue","computeCost","gutterBottom","Slider","marks","valueLabelDisplay","Array","valueLabelFormat","_index","Skill","skill","paddingTop","SkillList","skills","computeSkillCost","onSkillsUpdated","sort","localeCompare","onSkillUpdate","newSkills","skillIndex","ActiveSkillList","activeSkillsCost","allActiveSkills","KnowledgeSkillList","knowledgeSkillsCost","freeKnowledgeSkillPoints","totalCost","allKnowledgeSkills","LanguageSkillList","languageSkillsCost","allLanguageSkills","SkillsTab","badge","Karma","showZero","Attribute","modifier","AttributeList","filteredAttributes","attributesCost","newAttributes","attributeIndex","AttributesTab","getContactRatingCost","getContactCost","contact","connection","loyalty","getAllContactsCost","details","Contact","contactCost","updatedConnection","updatedContact","updatedLoyalty","ContactList","selectedContacts","contactsCost","freeContactPoints","charisma","willpower","getFreeContactPoints","onContactUpdate","newContacts","contactIndex","ContactsTab","MagicTab","_item","newSpells","GearTab","createGearCostLabel","createGearLabel","childNames","Set","add","from","getChildNames","newSubGear","newGear","handleUpdateGear","spellsRoot","transformSpellValues","theme","palette","getContrastText","primary","main","backgroundColor","ReadOnlyProperty","Avatar","section","CombatTab","body","agility","reaction","athletics","initiative","physicalBoxes","stunBoxes","sneaking","walking","running","bar","flexGrow","CharacterCreator","drawerOpen","setDrawerOpen","selectedTab","setSelectedTab","useEffect","fetch","then","response","json","allData","transformAllQualities","catch","message","stack","all","magic","spellData","transformAllSpells","gearData","transformAllGear","gearNuyenCostLabel","characterCost","skillsCost","magicCost","gearNuyenCost","getGearKarmaCost","round","selectedTabPanel","AppBar","position","Toolbar","edge","Tabs","_event","newValue","Tab","Drawer","createMuiTheme","App","useReducer","characterJSON","loadCharacters","selectedCharacterKey","loadSelectedCharacter","selectedCharacterRef","loadedCharacter","Provider","ThemeProvider","CssBaseline","window","location","hostname","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.05ca39cc.chunk.js","sourcesContent":["import { Contact } from \"./contact\";\r\nimport { Item } from \"./item\";\r\n\r\nexport enum MetaType {\r\n    Dwarf = \"Dwarf\",\r\n    Elf = \"Elf\",\r\n    Human = \"Human\",\r\n    Ork = \"Ork\",\r\n    Troll = \"Troll\",\r\n}\r\n\r\nexport type NamedProperty = {\r\n    name: string;\r\n    rating: number;\r\n};\r\n\r\nexport type Attribute = NamedProperty;\r\n\r\nexport type Skill = NamedProperty;\r\n\r\nexport type CharacterRef = {\r\n    key: number;\r\n    name: string;\r\n    streetName: string;\r\n};\r\n\r\nexport type Character = CharacterRef & {\r\n    metaType: MetaType;\r\n    attributes: Attribute[];\r\n    qualities: Item[];\r\n    activeSkills: Skill[];\r\n    knowledgeSkills: Skill[];\r\n    languageSkills: Skill[];\r\n    contacts: Contact[];\r\n    spells: Item[];\r\n    gear: Item[];\r\n};\r\n\r\nexport function isAwakened(character: Character): boolean {\r\n    return character.qualities.find(q => q.name === \"Adept\" || q.name === \"Magician\") !== undefined;\r\n}","import { Character, MetaType } from \"../model/character\";\r\n\r\nconst DEFAULT_KEY = -1;\r\nconst DEFAULT_CHARACTER: Character = {\r\n    key: DEFAULT_KEY,\r\n    name: \"\",\r\n    streetName: \"\",\r\n    metaType: MetaType.Human,\r\n    attributes: [\r\n        { name: \"Body\", rating: 3 },\r\n        { name: \"Agility\", rating: 3 },\r\n        { name: \"Reaction\", rating: 3 },\r\n        { name: \"Strength\", rating: 3 },\r\n        { name: \"Charisma\", rating: 3 },\r\n        { name: \"Intuition\", rating: 3 },\r\n        { name: \"Logic\", rating: 3 },\r\n        { name: \"Willpower\", rating: 3 },\r\n        { name: \"Edge\", rating: 3 },\r\n        { name: \"Magic\", rating: 3 },\r\n    ],\r\n    qualities: [],\r\n    activeSkills: [],\r\n    knowledgeSkills: [],\r\n    languageSkills: [],\r\n    contacts: [],\r\n    spells: [],\r\n    gear: [],\r\n};\r\n\r\nexport function getDefaultCharacter(): Character {\r\n    return { ...DEFAULT_CHARACTER };\r\n}\r\n\r\nexport function isDefaultCharacter(character: Character): boolean {\r\n    return JSON.stringify(DEFAULT_CHARACTER) === JSON.stringify(character);\r\n}\r\n\r\nexport function hasDefaultKey(character: Character): boolean {\r\n    return character.key === DEFAULT_KEY;\r\n}","import { Character, CharacterRef } from \"./model/character\";\r\nimport { CustomItem } from \"./model/custom-item\";\r\nimport { getDefaultCharacter } from \"./data/default-character\";\r\nimport { Dictionary } from \"./model/dictionary\";\r\n\r\nconst CHARACTER_KEY = \"character\";\r\n\r\nfunction createCharacterKey(key: number): string {\r\n    return `${CHARACTER_KEY}:${key}`;\r\n}\r\n\r\nexport function loadCharacters(): CharacterRef[] {\r\n    const characters: CharacterRef[] = [getDefaultCharacter()];\r\n    for (let i = 0; i < localStorage.length; i++) {\r\n        const key = localStorage.key(i);\r\n        if (key === null) {\r\n            continue;\r\n        }\r\n        // charater:1337\r\n        if (/^character:\\d+$/i.test(key)) {\r\n            const characterJSON = localStorage.getItem(key);\r\n            if (characterJSON) {\r\n                const { key, name, streetName } = JSON.parse(characterJSON);\r\n                characters.push({ key, name, streetName });\r\n            }\r\n        }\r\n    }\r\n    characters.sort((a, b) => a.key - b.key);\r\n    return characters;\r\n}\r\n\r\nexport function loadCharacter(key: number): Character | undefined {\r\n    if (key === -1) {\r\n        return getDefaultCharacter();\r\n    }\r\n    const character = localStorage.getItem(createCharacterKey(key));\r\n    if (character) {\r\n        return JSON.parse(character);\r\n    } else {\r\n        return undefined;\r\n    }\r\n}\r\n\r\nexport function saveCharacter(character: Character) {\r\n    localStorage.setItem(createCharacterKey(character.key), JSON.stringify(character));\r\n}\r\n\r\nexport function clearCharacter(character: Character) {\r\n    localStorage.removeItem(createCharacterKey(character.key));\r\n}\r\n\r\nconst SELECTED_CHARACTER_KEY = \"selected-character\";\r\n\r\nexport function loadSelectedCharacter(): number {\r\n    const selectedCharacter = localStorage.getItem(SELECTED_CHARACTER_KEY);\r\n    if (selectedCharacter) {\r\n        return parseInt(selectedCharacter);\r\n    } else {\r\n        return -1;\r\n    }\r\n}\r\n\r\nexport function saveSelectedCharacter(key: number) {\r\n    localStorage.setItem(SELECTED_CHARACTER_KEY, key.toString());\r\n}\r\n\r\nexport function clearSelectedCharacter() {\r\n    localStorage.removeItem(SELECTED_CHARACTER_KEY);\r\n}\r\n\r\nconst CUSTOM_ITEM_KEY = \"custom-item\";\r\n\r\nfunction createCustomItemKey(path: string, name: string): string {\r\n    return `${CUSTOM_ITEM_KEY}:${path}.${name}}`;\r\n}\r\n\r\nexport function loadCustomItems(): Dictionary<CustomItem> {\r\n    const customItems: Dictionary<CustomItem> = {};\r\n    for (let i = 0; i < localStorage.length; i++) {\r\n        const key = localStorage.key(i);\r\n        if (key === null) {\r\n            // not a custom item\r\n            continue;\r\n        }\r\n        /*\r\n        custom-item:category.group.name => [\r\n            \"custom-item:category.group.name\",\r\n            \"category.group\",\r\n            \"name\"\r\n        ]\r\n        */\r\n        const result = /^custom-item:(?:((?:(?:\\w+)(?:\\.)?)*)\\.)?(\\w+)$/i.exec(key);\r\n        if (result) {\r\n            const path = result[1];\r\n            const itemJSON = localStorage.getItem(key);\r\n            if (itemJSON) {\r\n                const item = JSON.parse(itemJSON);\r\n                customItems[path] = item;\r\n            }\r\n        }\r\n    }\r\n    return customItems;\r\n}\r\n\r\nexport function saveCustomItem(path: string, item: CustomItem) {\r\n    const key = createCustomItemKey(path, item.Name);\r\n    localStorage.setItem(key, JSON.stringify(item));\r\n}\r\n\r\nexport function clearCustomItem(path: string, item: CustomItem) {\r\n    const key = createCustomItemKey(path, item.Name);\r\n    localStorage.removeItem(key);\r\n}","import { MetaType } from \"./character\";\r\n\r\nexport function getMetaTypeCost(metaType: MetaType): number {\r\n    switch (metaType) {\r\n        case MetaType.Human:\r\n            return 0;\r\n        case MetaType.Ork:\r\n            return 40;\r\n        case MetaType.Dwarf:\r\n            return 50;\r\n        case MetaType.Elf:\r\n            return 60;\r\n        case MetaType.Troll:\r\n            return 80;\r\n        default:\r\n            throw new Error(`Unknown meta-type '${metaType}'`);\r\n    }\r\n}","import { MetaType, Attribute, Character, isAwakened } from \"./character\";\r\n\r\nexport function getEffectiveAttributeRating(character: Character, name: string): number {\r\n    const attribute = character.attributes.find(a => a.name === name);\r\n    if (!attribute) {\r\n        throw new Error(`Could not find attribute with name '${name}'`);\r\n    }\r\n    return attribute.rating + getAttributeModifier(character.metaType, attribute);\r\n}\r\n\r\nexport function getAttributeModifier(metaType: MetaType, attribute: Attribute): number {\r\n    switch (metaType) {\r\n        case MetaType.Dwarf:\r\n            switch (attribute.name) {\r\n                case \"Body\":\r\n                    return 1;\r\n                case \"Reaction\":\r\n                    return -1;\r\n                case \"Strength\":\r\n                    return 2;\r\n                case \"Willpower\":\r\n                    return 1;\r\n            }\r\n            break;\r\n        case MetaType.Elf:\r\n            switch (attribute.name) {\r\n                case \"Agility\":\r\n                    return 1;\r\n                case \"Charisma\":\r\n                    return 2;\r\n            }\r\n            break;\r\n        case MetaType.Human:\r\n            switch (attribute.name) {\r\n                case \"Edge\":\r\n                    return 1;\r\n            }\r\n            break;\r\n        case MetaType.Ork:\r\n            switch (attribute.name) {\r\n                case \"Body\":\r\n                    return 3;\r\n                case \"Strength\":\r\n                    return 2;\r\n                case \"Charisma\":\r\n                    return -1;\r\n                case \"Logic\":\r\n                    return -1;\r\n            }\r\n            break;\r\n        case MetaType.Troll:\r\n            switch (attribute.name) {\r\n                case \"Body\":\r\n                    return 4;\r\n                case \"Agility\":\r\n                    return -1;\r\n                case \"Strength\":\r\n                    return 4;\r\n                case \"Charisma\":\r\n                    return -2;\r\n                case \"Intuition\":\r\n                    return -1;\r\n                case \"Logic\":\r\n                    return -1;\r\n            }\r\n            break;\r\n    }\r\n    return 0;\r\n}\r\n\r\nexport function getAttributeCost(rating: number): number {\r\n    switch (rating) {\r\n        case 1:\r\n            return -25;\r\n        case 2:\r\n            return -15;\r\n        case 3:\r\n            return 0;\r\n        case 4:\r\n            return 20;\r\n        case 5:\r\n            return 45;\r\n        case 6:\r\n            return 75;\r\n        case 7:\r\n            return 110;\r\n        default:\r\n            throw new Error(`Unsupported attribute rating ${rating}`);\r\n    }\r\n}\r\n\r\nexport function getAttributesCost(character: Character): number {\r\n    const awakened = isAwakened(character);\r\n    let cost = 0;\r\n    for (const attribute of character.attributes) {\r\n        if (attribute.name === \"Magic\" && !awakened) {\r\n            // character could be awakened, have their Magic attribute, then be mundane\r\n            // ignore any Magic changes in this case\r\n            continue;\r\n        }\r\n        cost += getAttributeCost(attribute.rating);\r\n    }\r\n    return cost;\r\n}","import { Skill, Character } from \"./character\";\r\nimport { CustomItem } from \"./custom-item\";\r\n\r\nexport type Skills = {\r\n    active: CustomItem[];\r\n    knowledge: CustomItem[];\r\n    language: CustomItem[];\r\n};\r\n\r\nexport function getActiveSkillCost(rating: number): number {\r\n    switch (rating) {\r\n        case -1:\r\n            return 0;\r\n        case 1:\r\n            return 5;\r\n        case 3:\r\n            return 15;\r\n        case 5:\r\n            return 30;\r\n        default:\r\n            throw new Error(`Unsupported skill rating ${rating}`);\r\n    }\r\n}\r\n\r\nexport function getActiveSkillsCost(activeSkills: Skill[]): number {\r\n    return activeSkills.map(s => getActiveSkillCost(s.rating)).reduce((a, b) => a + b, 0);\r\n}\r\n\r\nexport function getKnowledgeSkillCost(rating: number): number {\r\n    switch (rating) {\r\n        case 1:\r\n            return 2;\r\n        case 3:\r\n            return 7;\r\n        case 5:\r\n            return 15;\r\n        default:\r\n            throw new Error(`Unsupported skill rating ${rating}`);\r\n    }\r\n}\r\n\r\nexport function getKnowledgeSkillsCost(knowledgeSkills: Skill[]): number {\r\n    return knowledgeSkills.map(s => getKnowledgeSkillCost(s.rating)).reduce((a, b) => a + b, 0);\r\n}\r\n\r\nexport function getFreeKnowledgeSkillPoints(character: Character): number {\r\n    const intuition = character.attributes.find(a => a.name === \"Intuition\");\r\n    if (intuition === undefined) {\r\n        throw new Error(`Character '${character.streetName}' has no attribute 'Intuition'`);\r\n    }\r\n    const logic = character.attributes.find(a => a.name === \"Logic\");\r\n    if (logic === undefined) {\r\n        throw new Error(`Character '${character.streetName}' has no attribute 'Logic'`);\r\n    }\r\n    return (intuition.rating + logic.rating) * 10;\r\n}\r\n\r\nexport function getSkillsCost(character: Character): number {\r\n    const activeSkillCost = getActiveSkillsCost(character.activeSkills);\r\n    const knowledgeSkillCost = getKnowledgeSkillsCost(character.knowledgeSkills);\r\n    // exclude native language\r\n    const languageSkillCost = getKnowledgeSkillsCost(character.languageSkills);\r\n    const freeKnowledgePoints = getFreeKnowledgeSkillPoints(character);\r\n    return activeSkillCost + Math.max(knowledgeSkillCost + languageSkillCost - freeKnowledgePoints, 0);\r\n}","import { sentenceCase } from \"change-case\";\r\nimport { isArray } from \"util\";\r\nimport { Item } from \"./item\";\r\n\r\nexport type Dictionary<T> = { [key: string]: T };\r\n\r\nexport function transformAllItems<T>(parentPath: string, parentData: any, allItems: Dictionary<T[]>, transformValues: (childpath: string, childValues: any[]) => T[]) {\r\n\tfor (const childName of Object.keys(parentData)) {\r\n\t\tconst childPath = `${parentPath}.${childName}`;\r\n\t\tconst childData = parentData[childName];\r\n\t\tif (isArray(childData)) {\r\n\t\t\tallItems[childPath] = transformValues(childPath, childData as any[]);\r\n\t\t} else {\r\n\t\t\ttransformAllItems(childPath, childData, allItems, transformValues);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst itemCostMap = new Map<string,number>();\r\nexport function getItemCost<T extends Item>(item: Item, allItems: Dictionary<T[]>): number {\r\n\tconst key = `${item.path}.${item.name}`;\r\n\tif (itemCostMap.has(key)) {\r\n\t\treturn itemCostMap.get(key)!;\r\n\t}\r\n\tconst items = allItems[item.path];\r\n\tconst foundItem = items.find(g => g.name === item.name);\r\n\tif (!foundItem) {\r\n\t\tthrow new Error(`Could not find item with name '${item.name}' in list '${JSON.stringify(items)}' under path '${item.path}'`);\r\n\t}\r\n\r\n\tconst cost = parseInt(foundItem.cost);\r\n\titemCostMap.set(key, cost);\r\n\treturn cost;\r\n}\r\n\r\nconst itemAvailabilityMap = new Map<string,string>();\r\nexport function getItemAvailability<T extends Item>(item: Item, allItems: Dictionary<T[]>): string {\r\n\tconst key = `${item.path}.${item.name}`;\r\n\tif (itemAvailabilityMap.has(key)) {\r\n\t\treturn itemAvailabilityMap.get(key)!;\r\n\t}\r\n\tconst items = allItems[item.path];\r\n\tconst foundItem = items.find(g => g.name === item.name);\r\n\tif (!foundItem) {\r\n\t\tthrow new Error(`Could not find item with name '${item.name}' in list '${JSON.stringify(items)}' under path '${item.path}'`);\r\n\t}\r\n\r\n\tconst availability = foundItem.availability;\r\n\titemAvailabilityMap.set(key, availability);\r\n\treturn availability;\r\n}\r\n\r\nexport function getNextParentPaths<T>(values: Dictionary<T>): Map<string,string> {\r\n\tconst parentPathToName = new Map<string,string>();\r\n\tconst paths = Object.keys(values).map(p => p.split(\".\"));\r\n\tlet componentIndex: number;\r\n\tif (paths.length > 1) {\r\n\t\tlet differenceFound = false;\r\n\t\tcomponentIndex = 0;\r\n\t\twhile (!differenceFound) {\r\n\t\t\tif (componentIndex >= paths[0].length) {\r\n\t\t\t\tthrow new Error(`Searched through all path components and found no differences`);\r\n\t\t\t}\r\n\t\t\tfor (let pathIndex = 1; pathIndex < paths.length; pathIndex++) {\r\n\t\t\t\tif (paths[0][componentIndex] !== paths[pathIndex][componentIndex]) {\r\n\t\t\t\t\tdifferenceFound = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcomponentIndex++;\r\n\t\t}\r\n\t} else if (paths.length === 1) {\r\n\t\t// there is only a single path so pick the last component\r\n\t\tcomponentIndex = paths[0].length - 1;\r\n\t} else {\r\n\t\tthrow new Error(`There are no paths`);\r\n\t}\r\n\tfor (const path of paths) {\r\n\t\tconst parentPath = path.slice(0, componentIndex).join(\".\");\r\n\t\tconst name = path[componentIndex - 1];\r\n\t\tparentPathToName.set(parentPath, sentenceCase(name));\r\n\t}\r\n\treturn parentPathToName;\r\n}\r\n\r\nexport function getChildNames<T>(values: Dictionary<T>, parentPath: string): string[] {\r\n\tconst childNames = new Set<string>();\r\n\tconst parents = parentPath.split(\".\");\r\n\tfor (const path of findChildPaths(values, parentPath)) {\r\n\t\tconst components = path.split(\".\");\r\n\t\tchildNames.add(components[parents.length]);\r\n\t}\r\n\treturn Array.from(childNames);\r\n}\r\n\r\nexport function getChildValues<T>(values: Dictionary<T[]>, parentPath: string): T[] {\r\n\tconst childValues: T[] = [];\r\n\tfor (const path of findChildPaths(values, parentPath)) {\r\n\t\tchildValues.push(...values[path]);\r\n\t}\r\n\treturn childValues;\r\n}\r\n\r\nexport function getChildSet<T>(values: Dictionary<T[]>, parentPath: string): Dictionary<T[]> {\r\n\tconst subset: Dictionary<T[]> = {};\r\n\tfor (const path of findChildPaths(values, parentPath)) {\r\n\t\tsubset[path] = values[path];\r\n\t}\r\n\treturn subset;\r\n}\r\n\r\nfunction findChildPaths<T>(values: Dictionary<T>, parentPath: string): string[] {\r\n\tconst childPaths: string[] = [];\r\n\tconst parents = parentPath.split(\".\");\r\n\tfor (const path of Object.keys(values)) {\r\n\t\tconst components = path.split(\".\");\r\n\t\tif (components.length < parents.length) {\r\n\t\t\tthrow new Error(`Child paths '${path}' must be longer than parent paths '${parentPath}'`);\r\n\t\t}\r\n\t\tlet match = true;\r\n\t\tfor (let i = 0; i < parents.length; i++) {\r\n\t\t\tif (parents[i] !== components[i]) {\r\n\t\t\t\tmatch = false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (match) {\r\n\t\t\tchildPaths.push(path);\r\n\t\t}\r\n\t}\r\n\treturn childPaths;\r\n}","import { CustomItem } from \"./custom-item\";\r\nimport { Item } from \"./item\";\r\nimport { Dictionary, transformAllItems, getItemCost } from \"./dictionary\";\r\nimport { Character } from \"./character\";\r\n\r\nexport type Quality = {\r\n    cost: string;\r\n} & Item;\r\n\r\nexport const qualitiesRoot = \"qualities\";\r\n\r\nexport function transformAllQualities(allData: any): Dictionary<Quality[]> {\r\n    const allQualities: Dictionary<Quality[]> = {};\r\n    transformAllItems(qualitiesRoot, allData, allQualities, transformQualityValues);\r\n    return allQualities;\r\n}\r\n\r\nfunction transformQualityValues(path: string, values: any[]): Quality[] {\r\n    const qualities: Quality[] = [];\r\n    for (const value of values) {\r\n        const name = value[\"Name\"];\r\n        const cost = value[\"Cost\"];\r\n        qualities.push({ path, name, cost });\r\n    }\r\n    return qualities;\r\n}\r\n\r\nexport type Qualities = {\r\n    positive: string[];\r\n    negative: string[]\r\n};\r\n\r\nexport type AllQualities = {\r\n    positive: CustomItem[];\r\n    negative: CustomItem[];\r\n}\r\n\r\nexport function getQualitiesCost(selectedQualities: string[], allQualities: CustomItem[]): number {\r\n    let cost = 0;\r\n    for (const selected of selectedQualities) {\r\n        const quality = allQualities.find(q => q.Name === selected);\r\n        if (!quality) {\r\n            throw new Error(`Could not find quality with name '${selected}' in list '${JSON.stringify(allQualities)}'`);\r\n        }\r\n        cost += parseInt(quality.Cost!);\r\n    }\r\n    return cost;\r\n}\r\n\r\nexport function getAllQualitiesCost(selectedQualities: { positive: string[], negative: string[] }, allQualities: AllQualities): number {\r\n    let cost = 0;\r\n    cost += getQualitiesCost(selectedQualities.positive, allQualities.positive);\r\n    cost += getQualitiesCost(selectedQualities.negative, allQualities.negative);\r\n    return cost;\r\n}\r\n\r\nexport function getCharacterQualitiesCost(character: Character, allQualities: Dictionary<Quality[]>): number {\r\n    let cost = 0;\r\n    for (const quality of character.qualities) {\r\n        cost += getItemCost(quality, allQualities);\r\n    }\r\n    return cost;\r\n}","import { Dictionary, transformAllItems, getItemCost, getItemAvailability } from \"./dictionary\";\r\nimport { Item } from \"./item\";\r\nimport { Character } from \"./character\";\r\n\r\nexport type Gear = {\r\n\tavailability: string;\r\n\tcost: string;\r\n\tcostLabel: string;\r\n} & Item;\r\n\r\nexport const gearRoot = \"gear\";\r\n\r\nexport function transformAllGear(allData: any): Dictionary<Gear[]> {\r\n\tconst allGear: Dictionary<Gear[]> = {};\r\n\ttransformAllItems(gearRoot, allData, allGear, transformGearValues);\r\n\treturn allGear;\r\n}\r\n\r\nfunction transformGearValues(path: string, values: any[]): Gear[] {\r\n\tconst items: Gear[] = [];\r\n\tfor (const item of values.map(v => transformGearItem(path, v))) {\r\n\t\t// gear with multiple versions need to be split into separate items\r\n\t\tif (/^([\\w-\\s]+)\\s+\\(([\\w-\\s]+(,\\s*)?)+\\)$/i.test(item.name)) {\r\n\t\t\titems.push(...splitGearItems(path, item));\r\n\t\t} else {\r\n\t\t\titems.push(item);\r\n\t\t}\r\n\t}\r\n\tfor (const item of items) {\r\n\t\tfinalizeGearItem(item);\r\n\t}\r\n\treturn items;\r\n}\r\n\r\nfunction transformGearItem(path: string, data: any): Gear {\r\n\tconst item: Gear = {\r\n\t\tpath,\r\n\t\tname: \"[NAME]\",\r\n\t\tavailability: \"[AVAILABILITY]\",\r\n\t\tcost: \"[COST]\",\r\n\t\tcostLabel: \"[COST]\"\r\n\t};\r\n\tfor (const propName of Object.keys(data)) {\r\n\t\tconst propValue = data[propName];\r\n\t\tif (propName === \"Name\") {\r\n\t\t\titem.name = propValue as string;\r\n\t\t} else if (propName === \"Availability\") {\r\n\t\t\titem.availability = propValue as string;\r\n\t\t} else if (propName === \"Cost\") {\r\n\t\t\titem.costLabel = propValue as string;\r\n\t\t} else {\r\n\t\t\t// assume a string (not that it actually matters)\r\n\t\t\titem[propName] = propValue as string;\r\n\t\t}\r\n\t}\r\n\treturn item;\r\n}\r\n\r\nfunction splitGearItems(path: string, item: Gear): Gear[] {\r\n\tconst itemVersions: Gear[] = [];\r\n\t/*\r\n\t\"Some Thingy (1, 2, 3)\" => [\r\n\t\t\"Some Thingy (A, B, C)\"\r\n\t\t\"Some Thingy\",\r\n\t\t\"A, B, C\"\r\n\t]\r\n\t*/\r\n\tconst groupResult = /^([\\w-\\s]+)\\s+\\(((?:(?:[\\w-\\s]+)(?:,\\s*)?)+)\\)$/i.exec(item.name);\r\n\tif (groupResult === null) {\r\n\t\tthrow new Error(`Gear item's name '${item.name}' does not contain multiple ratings`);\r\n\t}\r\n\tconst namePrefix = groupResult[1];\r\n\tconst nameSuffixes = groupResult[2].split(\",\").map(r => r.trim());\r\n\tconst itemCount = nameSuffixes.length;\r\n\tfor (let i = 0; i < itemCount; i++) {\r\n\t\tconst itemVersion: Gear = {\r\n\t\t\tpath,\r\n\t\t\tname: `${namePrefix} - ${nameSuffixes[i]}`,\r\n\t\t\tavailability: \"[AVAILABILITY]\",\r\n\t\t\tcost: \"[COST]\",\r\n\t\t\tcostLabel: \"[COST]\"\r\n\t\t};\r\n\t\tfor (const propName of Object.keys(item)) {\r\n\t\t\t// use lower-case names as this is the Gear object, not the raw object from the JSON file\r\n\t\t\tif (propName === \"name\") {\r\n\t\t\t\t// skip name - it is already set\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (propName === \"cost\") {\r\n\t\t\t\t// skip cost - it is determined in the finalize step, after splitting\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t// all other properties are strings\r\n\t\t\tconst propValue = item[propName] as string;\r\n\t\t\tconst splitValues = propValue.split(\",\").map(v => v.trim());\r\n\t\t\tif (splitValues.length === 1) {\r\n\t\t\t\t// same value for all versions\r\n\t\t\t\titemVersion[propName] = propValue;\r\n\t\t\t} else if (splitValues.length === itemCount) {\r\n\t\t\t\titemVersion[propName] = splitValues[i];\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(`Properties should have a single value or the same amount as there are version names ${itemCount} - found ${splitValues.length}`);\r\n\t\t\t}\r\n\t\t}\r\n\t\titemVersions.push(itemVersion);\r\n\t}\r\n\treturn itemVersions;\r\n}\r\n\r\nfunction finalizeGearItem(item: Gear) {\r\n\t/*\r\n\t1000\r\n\t+500\r\n\tx2\r\n\t50 (per dose)\r\n\t*/\r\n\tconst costResult = /^(?:x|\\+)?(\\d+)\\s*(?:\\(([\\w\\s]+)\\))?$/i.exec(item.costLabel);\r\n\tif (costResult) {\r\n\t\titem.cost = costResult[1];\r\n\t\tif (isNaN(parseInt(item.cost))) {\r\n\t\t\tthrow new Error(`Gear item '${item.name}' has unsupported cost label '${item.costLabel}'`);\r\n\t\t}\r\n\t} else {\r\n\t\titem.cost = \"0\";\r\n\t}\r\n}\r\n\r\nexport function computeItemCost(item: Item, allGear: Dictionary<Gear[]>): number {\r\n\tconst baseCost = getItemCost(item, allGear);\r\n\treturn baseCost * getGradeCostMultipler(item.grade as Grade) * getAvailabilityCostMultiplier(getItemAvailability(item, allGear));\r\n}\r\n\r\nexport function createSavedItem(path: string, item: Item): Item {\r\n\tconst { name, count, grade } = item;\r\n\tconst savedItem = { path, name, count, grade };\r\n\t// do not want to save optional properties\r\n\t// grade (used, alpha, beta, delta) only applies to augmentations\r\n\tif (grade === undefined) {\r\n\t\tdelete savedItem.grade;\r\n\t}\r\n\treturn savedItem;\r\n}\r\n\r\nexport enum Grade {\r\n\tUsed = \"Used\",\r\n\tAlpha = \"Alpha\",\r\n\tBeta = \"Beta\",\r\n\tDelta = \"Delta\"\r\n}\r\n\r\nexport function getGradeCostMultipler(grade: Grade = Grade.Alpha): number {\r\n\tswitch (grade) {\r\n\t\tcase Grade.Used:\r\n\t\t\treturn 0.5;\r\n\t\tcase Grade.Alpha:\r\n\t\t\treturn 1;\r\n\t\tcase Grade.Beta:\r\n\t\t\treturn 5;\r\n\t\tcase Grade.Delta:\r\n\t\t\treturn 15;\r\n\t\tdefault:\r\n\t\t\tthrow new Error(`Unknown augmentation grade '${grade}'`);\r\n\t}\r\n}\r\n\r\nexport function isItemAvailable(availability: string): boolean {\r\n\tconst { rating, legality } = parseAvailability(availability);\r\n\tswitch (legality) {\r\n\t\tcase \"L\":\r\n\t\t\treturn rating <= (18 + 6);\r\n\t\tcase \"R\":\r\n\t\t\treturn rating <= (12 + 6);\r\n\t\tcase \"F\":\r\n\t\t\treturn rating <= (6 + 6);\r\n\t\tdefault:\r\n\t\t\tthrow new Error(`Unknown availability legality '${legality}'`);\r\n\t}\r\n}\r\n\r\nexport function getAvailabilityCostMultiplier(availability: string): number {\r\n\tconst { rating, legality } = parseAvailability(availability);\r\n\r\n\tif (legality === \"F\") {\r\n\t\t// forbidden\r\n\t\tif (rating <= 6) {\r\n\t\t\treturn 1;\r\n\t\t} else if (rating <= 8) {\r\n\t\t\treturn 2;\r\n\t\t} else if (rating <= 10) {\r\n\t\t\treturn 5;\r\n\t\t} else if (rating <= 12) {\r\n\t\t\treturn 10;\r\n\t\t} else {\r\n\t\t\treturn Number.NaN;\r\n\t\t}\r\n\t} else if (legality === \"R\") {\r\n\t\t// restricted\r\n\t\tif (rating <= 12) {\r\n\t\t\treturn 1;\r\n\t\t} else if (rating <= 14) {\r\n\t\t\treturn 2;\r\n\t\t} else if (rating <= 16) {\r\n\t\t\treturn 5;\r\n\t\t} else if (rating <= 18) {\r\n\t\t\treturn 10;\r\n\t\t} else {\r\n\t\t\treturn Number.NaN;\r\n\t\t}\r\n\t} else {\r\n\t\t// legal\r\n\t\tif (rating <= 18) {\r\n\t\t\treturn 1;\r\n\t\t} else if (rating <= 20) {\r\n\t\t\treturn 2;\r\n\t\t} else if (rating <= 22) {\r\n\t\t\treturn 5;\r\n\t\t} else if (rating <= 24) {\r\n\t\t\treturn 10;\r\n\t\t} else {\r\n\t\t\treturn Number.NaN;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction parseAvailability(availability: string): { rating: number, legality: string } {\r\n\tif (availability === \"-\") {\r\n\t\treturn { rating: 1, legality: \"L\" };\r\n\t}\r\n\tconst result = /^\\+?(\\d+)(R|F)?$/i.exec(availability);\r\n\tif (!result) {\r\n\t\tconsole.error(`Unknown availability format '${availability}' - falling back to standard cost`);\r\n\t\treturn { rating: 1, legality: \"L\" };\r\n\t}\r\n\tconst rating = parseInt(result[1]);\r\n\tconst legality = result[2] || \"L\";\r\n\treturn { rating, legality };\r\n}\r\n\r\nexport function getGradeEssenseMultiplier(grade: Grade = Grade.Alpha): number {\r\n\tswitch (grade) {\r\n\t\tcase Grade.Used:\r\n\t\t\treturn 1.2;\r\n\t\tcase Grade.Alpha:\r\n\t\t\treturn 1;\r\n\t\tcase Grade.Beta:\r\n\t\t\treturn 0.7;\r\n\t\tcase Grade.Delta:\r\n\t\t\treturn 0.5;\r\n\t\tdefault:\r\n\t\t\tthrow new Error(`Unknown augmentation grade '${grade}'`);\r\n\t}\r\n}\r\n\r\nexport function getCharacterGearNuyenCost(character: Character, allGear: Dictionary<Gear[]>): number {\r\n\tlet nuyen = 0;\r\n\tfor (const item of character.gear) {\r\n\t\tnuyen += computeItemCost(item, allGear) * parseInt(item.count);\r\n\t}\r\n\treturn nuyen;\r\n}\r\n\r\nexport function getCharacterGearKarmaCost(nuyen: number): number {\r\n\t// Nuyen is bought at a rate of 5 Karma for 10000\r\n\t// All unspent nuyen is lost so round up\r\n\treturn Math.ceil(nuyen / 10000) * 5;\r\n}","import { Character } from \"./character\";\r\nimport { getMetaTypeCost } from \"./meta-type\";\r\nimport { getAttributesCost } from \"./attributes\";\r\nimport { getSkillsCost } from \"./skills\";\r\nimport { getCharacterQualitiesCost } from \"./quality\";\r\nimport { State } from \"./state\";\r\nimport { getCharacterGearKarmaCost, getCharacterGearNuyenCost } from \"./gear\";\r\n\r\nexport type Karma = {\r\n    total: number;\r\n    spent: number;\r\n    available: number;\r\n};\r\n\r\nconst STARTING_KARMA = 500;\r\n\r\nexport function getDefaultKarma(): Karma {\r\n    return {\r\n        total: STARTING_KARMA,\r\n        spent: 0,\r\n        available: STARTING_KARMA\r\n    };\r\n}\r\n\r\nexport function getCharacterKarma(karma: Karma, character: Character, state: State): Karma {\r\n    const { total } = karma;\r\n    let spent = 0;\r\n    spent += getMetaTypeCost(character.metaType);\r\n    spent += getCharacterQualitiesCost(character, state.allQualities);\r\n    spent += getAttributesCost(character);\r\n    spent += getSkillsCost(character);\r\n    spent += getCharacterGearKarmaCost(getCharacterGearNuyenCost(character, state.allGear));\r\n    const available = total - spent;\r\n    return { total, spent, available };\r\n}","import { Reducer } from \"react\";\r\nimport { State } from \"./model/state\";\r\nimport { getDefaultCharacter, isDefaultCharacter, hasDefaultKey } from \"./data/default-character\";\r\nimport { Character, CharacterRef } from \"./model/character\";\r\nimport { saveCharacter, clearCharacter, loadCharacter, saveCustomItem } from \"./persistance\";\r\nimport { getDefaultKarma, getCharacterKarma } from \"./model/karma\";\r\nimport { Quality } from \"./model/quality\";\r\nimport { Skills } from \"./model/skills\";\r\nimport { CustomItem } from \"./model/custom-item\";\r\nimport { Spell } from \"./model/magic\";\r\nimport { Gear } from \"./model/gear\";\r\nimport { Dictionary } from \"./model/dictionary\";\r\n\r\nexport enum ActionType {\r\n    UpdateCharacter = \"updateCharacter\",\r\n    SaveCharacter = \"saveCharacter\",\r\n    ClearCharacter = \"clearCharacter\",\r\n    SelectCharacter = \"selectCharacter\",\r\n    LoadQualities = \"loadQualities\",\r\n    LoadSkills = \"loadSkills\",\r\n    LoadContacts = \"loadContacts\",\r\n    LoadSpells = \"loadSpells\",\r\n    LoadGear = \"loadGear\",\r\n    LoadCustomItems = \"loadCustomItems\",\r\n    AddCustomItem = \"addCustomItem\"\r\n}\r\n\r\nexport type Action = {\r\n    type: ActionType;\r\n    data?: any;\r\n};\r\n\r\nexport type UpdateCharacterData = Character;\r\nexport type SelectCharacterData = CharacterRef;\r\nexport type LoadQualitiesData = Dictionary<Quality[]>;\r\nexport type LoadSkillsData = Skills;\r\nexport type LoadContactsData = CustomItem[];\r\nexport type LoadSpellsData = Dictionary<Spell[]>;\r\nexport type LoadGearData = Dictionary<Gear[]>;\r\nexport type LoadCustomItemsData = Dictionary<CustomItem>;\r\nexport type AddCustomItemData = { path: string, item: CustomItem };\r\n\r\nexport const reducer: Reducer<State, Action> = (state: State, action: Action): State => {\r\n    switch (action.type) {\r\n        case ActionType.UpdateCharacter: {\r\n            const selectedCharacter = action.data as UpdateCharacterData;\r\n            const karma = getCharacterKarma(state.karma, selectedCharacter, state);\r\n            return { ...state, selectedCharacter, karma };\r\n        }\r\n        case ActionType.SaveCharacter: {\r\n            if (hasDefaultKey(state.selectedCharacter)) {\r\n                // character has not been saved yet\r\n                if (isDefaultCharacter(state.selectedCharacter)) {\r\n                    // don't save copies of the empty character\r\n                    break;\r\n                }\r\n                state.selectedCharacter.key = Date.now();\r\n                const { key, name, streetName } = state.selectedCharacter;\r\n                state.characters.push({ key, name, streetName });\r\n            }\r\n            // the list of characters is not saved separatly - it is constructed from all the available characters\r\n            saveCharacter(state.selectedCharacter);\r\n            return { ...state};\r\n        }\r\n        case ActionType.ClearCharacter: {\r\n            clearCharacter(state.selectedCharacter);\r\n            const characters = state.characters\r\n                .filter(c => c.key !== state.selectedCharacter.key)\r\n                .map(({ key, name, streetName }) => ({ key, name, streetName }));\r\n            return { ...state, characters, selectedCharacter: getDefaultCharacter(), karma: getDefaultKarma() };\r\n        }\r\n        case ActionType.SelectCharacter: {\r\n            const characterRef = action.data as SelectCharacterData;\r\n            // Loading the app with a saved character can throw an error calculating karma cost, as the available data (qualities, etc) have not been loaded yet\r\n            // saveSelectedCharacter(characterRef.key);\r\n            const selectedCharacter = loadCharacter(characterRef.key);\r\n            if (!selectedCharacter) {\r\n                throw new Error(`Could not find saved character ${JSON.stringify(characterRef)}`);\r\n            }\r\n            const karma = getCharacterKarma(state.karma, selectedCharacter, state);\r\n            return { ...state, selectedCharacter, karma};\r\n        }\r\n        case ActionType.LoadQualities: {\r\n            const allQualities = action.data as LoadQualitiesData;\r\n            return { ...state, allQualities };\r\n        }\r\n        case ActionType.LoadSkills: {\r\n            const allSkills = action.data as LoadSkillsData;\r\n            return { ...state, allSkills };\r\n        }\r\n        case ActionType.LoadContacts: {\r\n            const allContacts = action.data as LoadContactsData;\r\n            return { ...state, allContacts}\r\n        }\r\n        case ActionType.LoadGear: {\r\n            const allGear = action.data as LoadGearData;\r\n            return { ...state, allGear };\r\n        }\r\n        case ActionType.LoadSpells: {\r\n            const allSpells = action.data as LoadSpellsData;\r\n            return { ...state, allSpells };\r\n        }\r\n        case ActionType.LoadCustomItems: {\r\n            const customItems = action.data as LoadCustomItemsData;\r\n            return { ...state, customItems };\r\n        }\r\n        case ActionType.AddCustomItem: {\r\n            const newItem = action.data as AddCustomItemData;\r\n            // persist item in local storage for later\r\n            saveCustomItem(newItem.path, newItem.item);\r\n            const customItems = { ...state.customItems };\r\n            customItems[newItem.path] = newItem.item;\r\n            return { ...state, customItems };\r\n        }\r\n    }\r\n    return { ...state };\r\n}\r\n\r\nexport const INITIAL_STATE: State = {\r\n    characters: [],\r\n    selectedCharacter: getDefaultCharacter(),\r\n    karma: getDefaultKarma(),\r\n    allQualities: { positive: [], negative: [] },\r\n    allSkills: { active: [], knowledge: [], language: [] },\r\n    allContacts: [],\r\n    allSpells: { combat: [], detection: [], health: [], illusion: [], manipulation: [] },\r\n    allGear: {},\r\n    customItems: {},\r\n};","import { createContext, Dispatch, useContext } from \"react\";\r\nimport { State } from \"./model/state\";\r\nimport { Action, INITIAL_STATE } from \"./reducer\";\r\n\r\nexport const DispatchContext = createContext<Dispatch<Action>>(() => {});\r\n\r\nexport const useDispatch = (): Dispatch<Action> => {\r\n    return useContext(DispatchContext);\r\n}\r\n\r\nexport const StateContext = createContext<State>(INITIAL_STATE);\r\n\r\nexport const useGlobalState = <K extends keyof State>(property: K) => {\r\n    const state = useContext(StateContext);\r\n    return state[property];\r\n}","import React, { FC } from \"react\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport { CharacterRef } from \"../model/character\";\r\n\r\n\r\ntype Props = {\r\n    character: CharacterRef;\r\n};\r\n\r\nconst CharacterName: FC<Props> = (props: Props) => {\r\n    const { character } = props;\r\n    const { name, streetName } = character;\r\n    if (!name && !streetName) {\r\n        return <Typography>= New Character =</Typography>;\r\n    }\r\n    if (!streetName) {\r\n        return <Typography>{name}</Typography>\r\n    }\r\n    if (!name) {\r\n        return <Typography>{streetName}</Typography>\r\n    }\r\n    return <Typography>{name} aka {streetName}</Typography>\r\n};\r\n\r\nexport default CharacterName;","import React, { FC } from \"react\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\r\nimport { useGlobalState, useDispatch } from \"../context\";\r\nimport CharacterName from \"./CharacterName\";\r\nimport { CharacterRef } from \"../model/character\";\r\nimport { ActionType, SelectCharacterData } from \"../reducer\";\r\n\r\nconst SelectCharacter: FC = () => {\r\n    const dispatch = useDispatch();\r\n    const characters = useGlobalState(\"characters\");\r\n\r\n    const onCharacterClick = (character: CharacterRef) => {\r\n        const data: SelectCharacterData = character;\r\n        dispatch({ type: ActionType.SelectCharacter, data });\r\n    };\r\n    return (\r\n        <List subheader={\r\n            <ListSubheader>Characters</ListSubheader>\r\n            }\r\n            >\r\n            {\r\n                characters.map(c => (\r\n                    <ListItem key={c.key} onClick={() => onCharacterClick(c)}>\r\n                        <CharacterName character={c} />\r\n                    </ListItem>\r\n                ))\r\n            }\r\n        </List>\r\n    )\r\n};\r\n\r\nexport default SelectCharacter;","import { MetaType } from \"../model/character\";\r\n\r\nexport const ALL_META_TYPES: MetaType[] = [\r\n    MetaType.Human,\r\n    MetaType.Ork,\r\n    MetaType.Dwarf,\r\n    MetaType.Elf,\r\n    MetaType.Troll\r\n];\r\n","import React, { FC } from \"react\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport { makeStyles, Badge } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles({\r\n\troot: {\r\n\t\tdisplay: \"flex\",\r\n\t\tflexDirection: \"row\",\r\n\t\tflexWrap: \"wrap\",\r\n\t\tjustifyContent: \"flex-start\"\r\n\t},\r\n\tchip: {\r\n\t\tmarginRight: 10,\r\n\t\tmarginBottom: 10,\r\n\t}\r\n});\r\n\r\ntype Props = {\r\n\tvalues: any[];\r\n\tcreateChipLabel: (value: any) => string;\r\n\tonDeleteValue: (value: any) => void;\r\n};\r\nconst ChipCollection: FC<Props> = (props: Props) => {\r\n\tconst { values, createChipLabel, onDeleteValue } = props;\r\n\r\n\tconst classes = useStyles();\r\n\r\n\treturn (\r\n\t\t<div className={classes.root}>\r\n\t\t\t{\r\n\t\t\t\tvalues.map(v =>\r\n\t\t\t\t\t<Badge badgeContent={v.count} invisible={v.count===\"1\"} color=\"secondary\" max={99} anchorOrigin={{ vertical: \"top\", horizontal: \"left\" }}>\r\n\t\t\t\t\t\t<Chip\r\n\t\t\t\t\t\t\tclassName={classes.chip}\r\n\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\tlabel={createChipLabel(v)}\r\n\t\t\t\t\t\t\tonDelete={() => onDeleteValue(v)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Badge>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ChipCollection;","import { Dictionary } from \"./dictionary\";\r\n\r\nexport type Item = {\r\n\tpath: string;\r\n\tname: string;\r\n} & Dictionary<string>;\r\n\r\nexport function getItemSubset(items: Item[], parentPath: string): Item[] {\r\n\tconst subItems: Item[] = [];\r\n\tfor (const item of items) {\r\n\t\tif (item.path === parentPath || item.path.startsWith(`${parentPath}.`)) {\r\n\t\t\tsubItems.push(item);\r\n\t\t}\r\n\t}\r\n\treturn subItems;\r\n}","import React, { FC } from \"react\";\r\nimport { Grade } from \"../model/gear\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles({\r\n\troot: {\r\n\t\tminWidth: 78,\r\n\t\tmaxWidth: 78,\r\n\t\twidth: 78,\r\n\t},\r\n})\r\ntype Props = {\r\n\tdisabled: boolean;\r\n\tgrade: Grade;\r\n\tonUpdateGrade: (newGrade: Grade) => void;\r\n};\r\nconst GradeButton: FC<Props> = (props: Props) => {\r\n\tconst { disabled, grade, onUpdateGrade } = props;\r\n\r\n\tconst classes = useStyles();\r\n\r\n\treturn (\r\n\t\t<Button\r\n\t\t\tclassName={classes.root}\r\n\t\t\tdisabled={disabled}\r\n\t\t\tvariant=\"outlined\"\r\n\t\t\tonClick={() => onUpdateGrade(nextGrade(grade))}\r\n\t\t>\r\n\t\t\t{grade}\r\n\t\t</Button>\r\n\t);\r\n};\r\n\r\nexport default GradeButton;\r\n\r\nfunction nextGrade(grade: Grade): Grade {\r\n\tswitch (grade)\t {\r\n\t\tcase Grade.Used:\r\n\t\t\treturn Grade.Alpha;\r\n\t\tcase Grade.Alpha:\r\n\t\t\treturn Grade.Beta;\r\n\t\tcase Grade.Beta:\r\n\t\t\treturn Grade.Delta;\r\n\t\tcase Grade.Delta:\r\n\t\t\treturn Grade.Used;\r\n\t\tdefault:\r\n\t\t\tthrow new Error(`Unknown augmentation grade '${grade}'`);\r\n\t}\r\n}","import React, { FC } from \"react\";\r\nimport { Item } from \"../model/item\";\r\nimport Badge from \"@material-ui/core/Badge\";\r\nimport ButtonGroup from \"@material-ui/core/ButtonGroup\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport RemoveIcon from \"@material-ui/icons/Remove\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\nimport { Grade, gearRoot, isItemAvailable } from \"../model/gear\";\r\nimport GradeButton from \"./GradeButton\";\r\n\r\nconst useStyles = makeStyles({\r\n\troot: {\r\n\t\tdisplay: \"flex\",\r\n\t\tflexDirection: \"row\",\r\n\t\tpadding: 10,\r\n\t\tmargin: 10,\r\n\t},\r\n\tname: {\r\n\t\twidth: 500,\r\n\t\ttextAlign: \"left\",\r\n\t},\r\n\tavailability: {\r\n\t\twidth: 100,\r\n\t\ttextAlign: \"center\"\r\n\t},\r\n\tcost: {\r\n\t\twidth: 200,\r\n\t\ttextAlign: \"center\"\r\n\t},\r\n});\r\n\r\ntype Props = {\r\n\titem: Item;\r\n\tcreateCostLabel: (item: Item) => string;\r\n\tonUpdateItem: (newItem: Item) => void;\r\n};\r\nconst ItemPickerCard: FC<Props> = (props: Props) => {\r\n\tconst { item, createCostLabel, onUpdateItem } = props;\r\n\r\n\tconst classes = useStyles();\r\n\r\n\tconst count = parseInt(item.count);\r\n\tconst costLabel = createCostLabel(item);\r\n\r\n\tconst hasAny = count > 0;\r\n\r\n\tconst allowMultiple = item.path.startsWith(gearRoot);\r\n\tconst includeAvailability = item.path.startsWith(gearRoot);\r\n\tconst available = includeAvailability ? isItemAvailable(item.availability) : true;\r\n\tconst includeGrade = item.path.startsWith(`${gearRoot}.augmentations`);\r\n\r\n\tconst grade = item.grade as Grade || Grade.Alpha;\r\n\r\n\tconst handleAdd = () => {\r\n\t\tonUpdateItem({ ...item, count: (count + 1).toString() });\r\n\t};\r\n\r\n\tconst handleRemove = () => {\r\n\t\tonUpdateItem({ ...item, count: Math.max(count - 1, 0).toString() });\r\n\t};\r\n\r\n\tconst handleGradeToggle = (newGrade: Grade) => {\r\n\t\tconst newItem = { ...item, grade: newGrade };\r\n\t\t// alpha is the default for cyber/bio and we don't want to 'dirty' all gear items with unnecessary grade properties\r\n\t\t// if it is never toggled it will never get added in the first place, so do not need to consider grade in the add/remove handlers\r\n\t\tif (newGrade === Grade.Alpha) {\r\n\t\t\tdelete newItem.grade;\r\n\t\t}\r\n\t\tonUpdateItem(newItem);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Paper\r\n\t\t\tclassName={classes.root}\r\n\t\t\televation={3}\r\n\t\t>\r\n\t\t\t<Typography className={classes.name} style={{lineHeight: \"36px\"}}>{item.name}</Typography>\r\n\t\t\t{ includeAvailability ? <Typography className={classes.availability} style={{lineHeight: \"36px\"}}>{item.availability}</Typography> : null }\r\n\t\t\t<span className={classes.cost}>\r\n\t\t\t\t<Badge badgeContent={count} color=\"secondary\">\r\n\t\t\t\t\t<Typography style={{lineHeight: \"36px\"}}>({costLabel})</Typography>\r\n\t\t\t\t</Badge>\r\n\t\t\t</span>\r\n\t\t\t<ButtonGroup>\r\n\t\t\t\t{ allowMultiple || !hasAny ? <Button onClick={handleAdd} disabled={!available}><AddIcon /></Button> : null }\r\n\t\t\t\t{ allowMultiple || hasAny ? <Button onClick={handleRemove} disabled={!available}><RemoveIcon /></Button> : null }\r\n\t\t\t\t{ includeGrade ? <GradeButton disabled={count === 0} grade={grade} onUpdateGrade={handleGradeToggle} /> : null }\r\n\t\t\t</ButtonGroup>\r\n\t\t</Paper>\r\n\t);\r\n};\r\n\r\nexport default ItemPickerCard;","import React, { FC, Fragment } from \"react\";\r\nimport { Item } from \"../model/item\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\nimport ItemPickerCard from \"./ItemPickerCard\";\r\n\r\nconst useStyles = makeStyles({\r\n\titems: {\r\n\t\tdisplay: \"flex\",\r\n\t\tflexDirection: \"column\",\r\n\t}\r\n});\r\n\r\ntype Props = {\r\n\tlabel: string;\r\n\titems: Item[];\r\n\tcreateCostLabel: (item: Item) => string;\r\n\tonUpdateItems: (newItems: Item[]) => void;\r\n};\r\nconst ItemPickerSection: FC<Props> = (props: Props) => {\r\n\tconst { items, createCostLabel, onUpdateItems } = props;\r\n\r\n\tconst classes = useStyles();\r\n\r\n\tconst handleUpdate = (item: Item) => {\r\n\t\tconst newItems = [...items];\r\n\t\tconst index = items.findIndex(i => i.name === item.name);\r\n\t\tnewItems[index] = item;\r\n\t\tonUpdateItems(newItems);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<Divider />\r\n\t\t\t<div className={classes.items}>\r\n\t\t\t\t{\r\n\t\t\t\t\titems\r\n\t\t\t\t\t?\r\n\t\t\t\t\titems.map(i =>\r\n\t\t\t\t\t\t<ItemPickerCard\r\n\t\t\t\t\t\t\titem={i}\r\n\t\t\t\t\t\t\tcreateCostLabel={createCostLabel}\r\n\t\t\t\t\t\t\tonUpdateItem={handleUpdate}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<div>No items</div>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t</Fragment>\r\n\t);\r\n};\r\n\r\nexport default ItemPickerSection;","import React, { FC, useState, ChangeEvent } from \"react\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport { Item } from \"../model/item\";\r\nimport { Dictionary } from \"../model/dictionary\";\r\nimport { sentenceCase } from \"change-case\";\r\nimport ItemPickerSection from \"./ItemPickerSection\";\r\n\r\n\r\ntype Props = {\r\n\topen: boolean;\r\n\tonClose: () => void;\r\n\ttitle: string;\r\n\tallItems: Dictionary<Item[]>;\r\n\tcreateCostLabel: (item: Item) => string;\r\n\tonUpdateAllItems: (newItems: Dictionary<Item[]>) => void;\r\n};\r\nconst ItemPickerDialog: FC<Props> = (props: Props) => {\r\n\tconst { open, onClose, title, allItems, createCostLabel, onUpdateAllItems } = props;\r\n\r\n\tconst allPaths = Object.keys(allItems);\r\n\r\n\tconst paths = [...allPaths];\r\n\r\n\tconst pathToLabel = new Map<string,string>();\r\n\tfor (const path of paths) {\r\n\t\tconst components = path.split(\".\");\r\n\t\tconst finalComponent = components[components.length - 1];\r\n\t\tconst label = sentenceCase(finalComponent);\r\n\t\tpathToLabel.set(path, label);\r\n\t}\r\n\r\n\tconst [group, setGroup] = useState(paths[0]);\r\n\r\n\t// once the dialog is rendered the state is 'remembered' for next use which could be different data\r\n\tif (paths.find(p => p === group) === undefined) {\r\n\t\tsetGroup(paths[0]);\r\n\t}\r\n\r\n\tconst handleGroupChange = (event: ChangeEvent<any>) => {\r\n\t\tsetGroup(event.target.value);\r\n\t};\r\n\r\n\tconst handleUpdateItems = (subItems: Item[]) => {\r\n\t\tconst newAllItems: Dictionary<Item[]> = { ...allItems };\r\n\t\tnewAllItems[group] = subItems;\r\n\t\tonUpdateAllItems(newAllItems);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Dialog open={open} onClose={onClose}>\r\n\t\t\t<DialogTitle>{title}</DialogTitle>\r\n\t\t\t<DialogContent>\r\n\t\t\t\t{\r\n\t\t\t\t\tpaths.length > 1\r\n\t\t\t\t\t?\r\n\t\t\t\t\t<Select\r\n\t\t\t\t\t\tid=\"group\"\r\n\t\t\t\t\t\tvalue={group}\r\n\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\tonChange={handleGroupChange}\r\n\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tpaths.map(p => (\r\n\t\t\t\t\t\t\t\t<MenuItem\r\n\t\t\t\t\t\t\t\t\tkey={p}\r\n\t\t\t\t\t\t\t\t\tvalue={p}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{pathToLabel.get(p)!}\r\n\t\t\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Select>\r\n\t\t\t\t\t:\r\n\t\t\t\t\tnull\r\n\t\t\t\t}\r\n\t\t\t\t<ItemPickerSection\r\n\t\t\t\t\tlabel={pathToLabel.get(group)!}\r\n\t\t\t\t\titems={allItems[group]}\r\n\t\t\t\t\tcreateCostLabel={createCostLabel}\r\n\t\t\t\t\tonUpdateItems={handleUpdateItems}\r\n\t\t\t\t/>\r\n\t\t\t</DialogContent>\r\n\t\t</Dialog>\r\n\t);\r\n};\r\n\r\nexport default ItemPickerDialog;","import React, { FC, Fragment, useState } from \"react\";\r\nimport { Dictionary, getNextParentPaths } from \"../model/dictionary\";\r\nimport { Item, getItemSubset } from \"../model/item\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport ItemPickerDialog from \"./ItemPickerDialog\";\r\nimport { Menu, MenuItem } from \"@material-ui/core\";\r\nimport { createSavedItem } from \"../model/gear\";\r\nimport { getChildSet } from \"../model/dictionary\";\r\nimport { sentenceCase } from \"change-case\";\r\n\r\ntype Props = {\r\n\ttitle: string;\r\n\titems: Item[];\r\n\tallItems: Dictionary<Item[]>;\r\n\tcreateCostLabel: (item: Item) => string;\r\n\tonUpdateItems: (newItems: Item[]) => void;\r\n};\r\nconst ItemPickerButton: FC<Props> = (props: Props) => {\r\n\tconst { title, items, allItems, createCostLabel, onUpdateItems } = props;\r\n\r\n\tconst [open, setOpen] = useState(false);\r\n\tconst handleClose = () => setOpen(false);\r\n\r\n\tconst parentPathsToName = getNextParentPaths(allItems);\r\n\r\n\tconst parentPaths: string[] = [];\r\n\tfor (const parentPath of parentPathsToName.keys()) {\r\n\t\tparentPaths.push(parentPath);\r\n\t}\r\n\r\n\tconst [parentPath, setParentPath] = useState(parentPaths[0]);\r\n\r\n\tconst [menuAnchor, setMenuAnchor] = useState<HTMLButtonElement | null>(null);\r\n\r\n\tconst handleMenuClick = (parentPath: string) => {\r\n\t\tsetParentPath(parentPath);\r\n\t\tsetMenuAnchor(null);\r\n\t\tsetOpen(true);\r\n\t};\r\n\r\n\tconst allChildItems = getChildSet(allItems, parentPath);\r\n\r\n\tconst allCountedItems: Dictionary<Item[]> = {};\r\n\tlet hasItems = false;\r\n\tfor (const path of Object.keys(allChildItems)) {\r\n\t\thasItems = true;\r\n\t\tconst localItems = [...allChildItems[path]];\r\n\t\tconst matchingItems = getItemSubset(items, parentPath);\r\n\t\tfor (const localItem of localItems) {\r\n\t\t\tconst matchingItem = matchingItems.find(i => i.name === localItem.name);\r\n\t\t\tif (matchingItem) {\r\n\t\t\t\tlocalItem.count = matchingItem.count;\r\n\t\t\t\tlocalItem.grade = matchingItem.grade;\r\n\t\t\t} else {\r\n\t\t\t\tlocalItem.count = \"0\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tallCountedItems[path] = localItems;\r\n\t}\r\n\r\n\tconst handleUpdateAllItems = (newCountedItems: Dictionary<Item[]>) => {\r\n\t\tconst newItems: Item[] = [...items];\r\n\r\n\t\tfor (const path of Object.keys(newCountedItems)) {\r\n\t\t\tfor (const localItem of newCountedItems[path]) {\r\n\t\t\t\tconst includeItem = parseInt(localItem.count) > 0;\r\n\t\t\t\tconst index = newItems.findIndex(i => i.path === path && i.name === localItem.name);\r\n\t\t\t\tif (index > -1) {\r\n\t\t\t\t\tif (includeItem) {\r\n\t\t\t\t\t\tnewItems[index] = createSavedItem(path, localItem);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnewItems.splice(index, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (includeItem) {\r\n\t\t\t\t\tnewItems.push(createSavedItem(path, localItem));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tonUpdateItems(newItems);\r\n\t};\r\n\t\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<IconButton\r\n\t\t\t\tonClick={event => setMenuAnchor(event.currentTarget)}\r\n\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\tsize=\"medium\"\r\n\t\t\t\tdisableRipple\r\n\t\t\t>\r\n\t\t\t\t<EditIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t<Menu\r\n\t\t\t\tanchorEl={menuAnchor}\r\n\t\t\t\topen={Boolean(menuAnchor)}\r\n\t\t\t\tonClose={() => setMenuAnchor(null)}\r\n\t\t\t>\r\n\t\t\t\t{\r\n\t\t\t\t\tparentPaths.map(p => (\r\n\t\t\t\t\t\t<MenuItem key={p} onClick={() => {handleMenuClick(p)}}>\r\n\t\t\t\t\t\t\t{sentenceCase(parentPathsToName.get(p)!)}\r\n\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t))\r\n\t\t\t\t}\r\n\t\t\t</Menu>\r\n\t\t\t{\r\n\t\t\t\thasItems\r\n\t\t\t\t?\r\n\t\t\t\t<ItemPickerDialog\r\n\t\t\t\t\topen={open}\r\n\t\t\t\t\tonClose={handleClose}\r\n\t\t\t\t\ttitle={`${title} - ${parentPathsToName.get(parentPath)!}`}\r\n\t\t\t\t\tallItems={allCountedItems}\r\n\t\t\t\t\tcreateCostLabel={createCostLabel}\r\n\t\t\t\t\tonUpdateAllItems={handleUpdateAllItems}\r\n\t\t\t\t/>\r\n\t\t\t\t:\r\n\t\t\t\tnull\r\n\t\t\t}\r\n\t\t</Fragment>\r\n\t);\r\n};\r\n\r\nexport default ItemPickerButton;","import React, { FC } from \"react\";\r\nimport ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\r\nimport ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\r\nimport ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport { Dictionary } from \"../model/dictionary\";\r\nimport { Item } from \"../model/item\";\r\nimport ChipCollection from \"./ChipCollection\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\nimport ItemPickerButton from \"./ItemPickerButton\";\r\nimport { Gear, computeItemCost } from \"../model/gear\";\r\n\r\nconst useStyles = makeStyles({\r\n    headerLabel: {\r\n        lineHeight: 3,\r\n        fontWeight: 700,\r\n    },\r\n});\r\n\r\n\r\ntype Props = {\r\n\tlabel: string;\r\n\titems: Item[];\r\n\tallItems: Dictionary<Item[]>;\r\n\tcreateItemLabel: (item: Item) => string;\r\n\tcreateItemCostLabel: (item: Item) => string;\r\n\tonUpdateItems: (newItems: Item[]) => void;\r\n};\r\nconst GroupContainer: FC<Props> = (props: Props) => {\r\n\tconst { label, items, allItems, createItemLabel, createItemCostLabel, onUpdateItems } = props;\r\n\r\n\tconst classes = useStyles();\r\n\r\n\tlet cost = 0;\r\n\tfor (const item of items) {\r\n\t\tcost += computeItemCost(item, allItems as Dictionary<Gear[]>) * parseInt(item.count);\r\n\t}\r\n\r\n\tconst flatItems: Item[] = [];\r\n\tfor (const path of Object.keys(allItems)) {\r\n\t\tflatItems.push(...allItems[path]);\r\n\t}\r\n\r\n\tconst handleDelete = (toDelete: Item) => {\r\n\t\tconst newItems = [...items];\r\n\t\tconst index = newItems.findIndex(i => i.name === toDelete.name);\r\n\t\tif (index < 0) {\r\n\t\t\tthrow new Error(`Could not find item '${toDelete.name}' to delete in list '${JSON.stringify(newItems)}'`);\r\n\t\t}\r\n\t\tnewItems.splice(index, 1);\r\n\t\tonUpdateItems(newItems);\r\n\t};\r\n\r\n\tconst handleUpdateItems = (newItems: Item[]) => {\r\n\t\tonUpdateItems(newItems);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<ExpansionPanel defaultExpanded={false}>\r\n\t\t\t<ExpansionPanelSummary expandIcon={<ExpandMoreIcon />} >\r\n\t\t\t\t<FormControlLabel\r\n\t\t\t\t\tonClick={(event) => event.stopPropagation()}\r\n\t\t\t\t\tonFocus={(event) => event.stopPropagation()}\r\n\t\t\t\t\tcontrol={<ItemPickerButton\r\n\t\t\t\t\t\ttitle={label}\r\n\t\t\t\t\t\titems={items}\r\n\t\t\t\t\t\tallItems={allItems}\r\n\t\t\t\t\t\tcreateCostLabel={createItemCostLabel}\r\n\t\t\t\t\t\tonUpdateItems={handleUpdateItems}\r\n\t\t\t\t\t/>}\r\n\t\t\t\t\tlabel=\"\"\r\n\t\t\t\t/>\r\n\t\t\t\t<Typography className={classes.headerLabel}>{label} ({cost})</Typography>\r\n\t\t\t</ExpansionPanelSummary>\r\n\t\t\t<ExpansionPanelDetails>\r\n\t\t\t\t<ChipCollection\r\n\t\t\t\t\tvalues={items}\r\n\t\t\t\t\tcreateChipLabel={createItemLabel}\r\n\t\t\t\t\tonDeleteValue={handleDelete}\r\n\t\t\t\t/>\r\n\t\t\t</ExpansionPanelDetails>\r\n\t\t</ExpansionPanel>\r\n\t);\r\n};\r\n\r\nexport default GroupContainer;","import React, { FC } from \"react\";\r\nimport { useDispatch, useGlobalState } from \"../context\";\r\nimport { Item } from \"../model/item\";\r\nimport { getItemCost } from \"../model/dictionary\";\r\nimport GroupContainer from \"./GroupContainer\";\r\nimport { ActionType, UpdateCharacterData } from \"../reducer\";\r\n\r\nconst QualitiesSection: FC = () => {\r\n\tconst dispatch = useDispatch();\r\n\tconst character = useGlobalState(\"selectedCharacter\");\r\n\tconst { qualities } = character;\r\n\tconst allQualities = useGlobalState(\"allQualities\");\r\n\r\n\tconst createQualityCostLabel = (item: Item) => {\r\n\t\tconst cost = getItemCost(item, allQualities);\r\n\t\tif (cost > 0) {\r\n\t\t\treturn `+${cost}`;\r\n\t\t} else {\r\n\t\t\treturn `${cost}`;\r\n\t\t}\r\n\t}\r\n\r\n\tconst createQualityLabel = (item: Item) => {\r\n\t\tconst { name } = item;\r\n\t\tconst costLabel = createQualityCostLabel(item);\r\n\t\treturn `${name} (${costLabel})`;\r\n\t};\r\n\r\n\tconst handleUpdateQualities = (newQualities: Item[]) => {\r\n\t\tconst data: UpdateCharacterData = { ...character, qualities: newQualities };\r\n\t\tdispatch({ type: ActionType.UpdateCharacter, data });\r\n\t};\r\n\r\n\treturn (\r\n\t\t<GroupContainer\r\n\t\t\tlabel=\"Qualities\"\r\n\t\t\titems={qualities}\r\n\t\t\tallItems={allQualities}\r\n\t\t\tcreateItemLabel={createQualityLabel}\r\n\t\t\tcreateItemCostLabel={createQualityCostLabel}\r\n\t\t\tonUpdateItems={handleUpdateQualities}\r\n\t\t/>\r\n\t);\r\n};\r\n\r\nexport default QualitiesSection;","import React, { FC, Fragment } from \"react\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { useDispatch, useGlobalState } from \"../context\";\r\nimport { Character as CharacterData, MetaType } from \"../model/character\";\r\nimport { ActionType, UpdateCharacterData } from \"../reducer\";\r\nimport { ALL_META_TYPES } from \"../data/meta-types\";\r\nimport { getMetaTypeCost } from \"../model/meta-type\";\r\nimport QualitiesSection from \"./QualitiesSection\";\r\n\r\nconst useStyles = makeStyles({\r\n    header: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        marginLeft: 5,\r\n        marginRight: 5,\r\n        marginBottom: 10,\r\n    },\r\n    field: {\r\n        marginRight: 10,\r\n        marginTop: 20,\r\n    },\r\n    divider: {\r\n        margin: 5,\r\n    }\r\n});\r\n\r\nconst CharacterTab: FC = () => {\r\n    const classes = useStyles();\r\n    const dispatch = useDispatch();\r\n    const character = useGlobalState(\"selectedCharacter\");\r\n    const { name, streetName, metaType } = character;\r\n\r\n    const onCharacterUpdated = (updatedCharacter: CharacterData) => {\r\n        const data: UpdateCharacterData = updatedCharacter;\r\n        dispatch({ type: ActionType.UpdateCharacter, data });\r\n    };\r\n\r\n    return (\r\n        <Fragment>\r\n            <div className={classes.header}>\r\n                <TextField id-=\"name\" label=\"Name\" value={name} onChange={e => onCharacterUpdated({ ...character, name: e.target.value})} className={classes.field} variant=\"outlined\" />\r\n                <TextField id-=\"street-name\" label=\"Street Name\" value={streetName} onChange={e => onCharacterUpdated({ ...character, streetName: e.target.value})} className={classes.field} variant=\"outlined\" />\r\n                <Select id=\"meta-type\" value={metaType} displayEmpty onChange={e => onCharacterUpdated({ ...character, metaType: e.target.value as MetaType})} className={classes.field} variant=\"outlined\">\r\n                    {ALL_META_TYPES.map(t => <MenuItem key={t} value={t}>{t} ({getMetaTypeCost(t)})</MenuItem>)}\r\n                </Select>\r\n            </div>\r\n            <QualitiesSection />\r\n        </Fragment>\r\n    )\r\n}\r\n\r\nexport default CharacterTab;","import { Dictionary } from \"./dictionary\";\r\n\r\nexport type CustomItem = {\r\n    Name: string;\r\n    Availability?: string;\r\n    Cost?: string;\r\n};\r\n\r\nexport function getChildItems(customItems: Dictionary<CustomItem>, parentPath: string): CustomItem[] {\r\n\tconst items: CustomItem[] = [];\r\n\tfor (const path in customItems) {\r\n\t\tif (path.startsWith(parentPath)) {\r\n\t\t\titems.push(customItems[path]);\r\n\t\t}\r\n\t}\r\n\treturn items;\r\n}","import React, { FC, Fragment, useState } from \"react\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport RemoveIcon from \"@material-ui/icons/Remove\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport { CustomItem } from \"../model/custom-item\";\r\n\r\nexport type SelectableItem = CustomItem & {\r\n\tselected: boolean;\r\n};\r\n\r\nconst useStyles = makeStyles(({\r\n\tcontent: {\r\n\t\twidth: \"100%\",\r\n\t},\r\n\theader: {\r\n\t\tdisplay: \"flex\",\r\n\t},\r\n\tname: {\r\n\t\tminWidth: 300,\r\n\t\tmaxWidth: 300,\r\n\t\ttextAlign: \"left\",\r\n\t},\r\n\tavailability: {\r\n\t\tminWidth: 100,\r\n\t\tmaxWidth: 100,\r\n\t\ttextAlign: \"center\",\r\n\t},\r\n\tcost: {\r\n\t\tminWidth: 100,\r\n\t\tmaxWidth: 100,\r\n\t\ttextAlign: \"right\",\r\n\t},\r\n\tul: {\r\n\t\tpadding: 0,\r\n\t},\r\n}));\r\n\r\ntype Props = {\r\n\topen: boolean;\r\n\tonClose: () => void;\r\n\ttitle: string;\r\n\titems: SelectableItem[];\r\n\tonItemSelectionChange: (item: SelectableItem) => void;\r\n\tincludeAvailability: boolean;\r\n\tincludeCost: boolean;\r\n\tallowNewItems: boolean;\r\n\tallowMultiSelection: boolean;\r\n};\r\nconst PickerDialog: FC<Props> = (props: Props) => {\r\n\tconst { open, onClose, title, items, onItemSelectionChange, includeAvailability, includeCost, allowNewItems, allowMultiSelection } = props;\r\n\r\n\tconst classes = useStyles();\r\n\r\n\tconst [newItemName, setNewItemName] = useState(\"\");\r\n\tconst [newItemAvailability, setNewItemAvailability] = useState(\"\");\r\n\tconst [newItemCost, setNewItemCost] = useState(\"\");\r\n\r\n\tconst onUpdateNewItem = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tconst value = event.target.value;\r\n\t\tswitch (event.target.id) {\r\n\t\t\tcase \"new-item-name\": {\r\n\t\t\t\tsetNewItemName(value);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"new-item-availability\": {\r\n\t\t\t\tsetNewItemAvailability(value);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase \"new-item-cost\": {\r\n\t\t\t\tsetNewItemCost(value);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst onCreateNewItem = () => {\r\n\t\tconst item: SelectableItem = { Name: newItemName, selected: true };\r\n\t\tif (includeAvailability) {\r\n\t\t\titem.Availability = newItemAvailability;\r\n\t\t}\r\n\t\tif (includeCost) {\r\n\t\t\titem.Cost = newItemCost;\r\n\t\t}\r\n\t\tonItemSelectionChange(item);\r\n\t\t// clear the new item fields after adding a new item (don't want fat-finger duplicates)\r\n\t\tsetNewItemName(\"\");\r\n\t\tsetNewItemAvailability(\"\");\r\n\t\tsetNewItemCost(\"\");\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Dialog open={open} onClose={onClose}>\r\n\t\t\t<DialogTitle>{title}</DialogTitle>\r\n\t\t\t<DialogContent className={classes.content}>\r\n\t\t\t\t<List>\r\n\t\t\t\t\t<ListItem key=\"header\" className={classes.header}>\r\n\t\t\t\t\t\t<Typography className={classes.name}>Name</Typography>\r\n\t\t\t\t\t\t{ includeAvailability ? <Typography className={classes.availability}>i.availability</Typography> : null }\r\n\t\t\t\t\t\t{ includeCost ? <Typography className={classes.cost}>Cost</Typography> : null }\r\n\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tallowNewItems ?\r\n\t\t\t\t\t\t<ListItem key=\"new-item\">\r\n\t\t\t\t\t\t\t<TextField id=\"new-item-name\" label=\"Custom\" value={newItemName} onChange={onUpdateNewItem} className={classes.name} variant=\"outlined\" />\r\n\t\t\t\t\t\t\t{ includeAvailability ? <TextField id=\"new-item-availability\" label=\"Availability\" value={newItemAvailability} onChange={onUpdateNewItem} className={classes.availability} variant=\"outlined\" /> : null }\r\n\t\t\t\t\t\t\t{ includeCost ? <TextField id=\"new-item-cost\" label=\"Cost\" value={newItemCost} onChange={onUpdateNewItem} className={classes.cost} variant=\"outlined\" /> : null }\r\n\t\t\t\t\t\t\t<IconButton aria-label=\"create\" onClick={onCreateNewItem} color=\"secondary\" size=\"small\">\r\n\t\t\t\t\t\t\t\t<AddIcon />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\tnull\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\titems.map(item => (\r\n\t\t\t\t\t\t\t<ListItem key={item.Name}>\r\n\t\t\t\t\t\t\t\t<ListItemText className={classes.name}>{item.Name}</ListItemText>\r\n\t\t\t\t\t\t\t\t{ includeAvailability ? <ListItemText className={classes.availability}>{item.Availability}</ListItemText> : null }\r\n\t\t\t\t\t\t\t\t{ includeCost ? <ListItemText className={classes.cost}>{item.Cost}</ListItemText> : null }\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tallowMultiSelection ?\r\n\t\t\t\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t\t\t\t<IconButton aria-label=\"add\" onClick={() => onItemSelectionChange({ ...item, selected: true })} color=\"secondary\" size=\"small\">\r\n\t\t\t\t\t\t\t\t\t\t\t<AddIcon />\r\n\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t<IconButton aria-label=\"remove\" onClick={() => onItemSelectionChange({ ...item, selected: false })} disabled={!item.selected} color=\"secondary\" size=\"small\">\r\n\t\t\t\t\t\t\t\t\t\t\t<RemoveIcon />\r\n\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t<IconButton aria-label={item.selected ? \"remove\" : \"add\"} onClick={() => onItemSelectionChange({ ...item, selected: !item.selected })} color=\"secondary\" size=\"small\">\r\n\t\t\t\t\t\t\t\t\t\t{ item.selected ? <RemoveIcon /> : <AddIcon /> }\r\n\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t))\r\n\t\t\t\t\t}\r\n\t\t\t\t</List>\r\n\t\t\t</DialogContent>\r\n\t\t</Dialog>\r\n\t);\r\n};\r\n\r\nexport default PickerDialog;","import React, { FC, Fragment, useState } from \"react\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport PickerDialog, { SelectableItem } from \"./PickerDialog\";\r\n\r\nconst NAME_INDEX = 0;\r\nconst COST = \"Cost\";\r\nconst AVAILABILITY = \"Availability\";\r\n\r\nconst findName = (value: any): string => {\r\n\tconst nameProp = Object.keys(value)[NAME_INDEX];\r\n\tconst name = value[nameProp];\r\n\tif (name === undefined) {\r\n\t\tthrow new Error(`Could not find a name for value '${JSON.stringify(value)}'`);\r\n\t}\r\n\treturn name as string;\r\n};\r\n\r\nconst findCost = (value: any): string => {\r\n\tconst cost = value[COST];\r\n\tif (cost === undefined) {\r\n\t\t// throw new Error(`Could not find a cost for value '${JSON.stringify(value)}'`);\r\n\t\treturn \"0\";\r\n\t}\r\n\treturn cost;\r\n};\r\n\r\nconst findAvailability = (value: any): string => {\r\n\tconst availability = value[AVAILABILITY];\r\n\tif (availability === undefined) {\r\n\t\t// throw new Error(`Could not find an availability for value '${JSON.stringify(value)}'`);\r\n\t\treturn \"-\";\r\n\t}\r\n\treturn availability;\r\n};\r\n\r\nconst createSelectableItem = (value: any, selectedValueNames: string[], includeAvailability: boolean, includeCost: boolean): SelectableItem => {\r\n\tconst Name = findName(value);\r\n\tconst Availability = includeAvailability ? findAvailability(value) : undefined;\r\n\tconst Cost = includeCost ? findCost(value) : undefined;\r\n\tconst selected = selectedValueNames.find(n => n === Name) !== undefined;\r\n\treturn { Name, Cost, Availability, selected\t};\r\n};\r\n\r\nconst useStyles = makeStyles({\r\n    editButton: {\r\n        paddingLeft: 10,\r\n    },\r\n});\r\n\r\ntype Props = {\r\n\tbreadcrums: string[];\r\n\tvalues: any[];\r\n\tselectedValueNames: string[];\r\n\taddValue: (name: string) => void;\r\n\tremoveValue: (name: string) => void;\r\n\tincludeAvailability?: boolean;\r\n\tincludeCost?: boolean;\r\n\tallowNewValues?: boolean;\r\n\tcreateValue?: (value: any) => void;\r\n\tallowMultiSelection?: boolean;\r\n};\r\nconst PickerButton: FC<Props> = (props: Props) => {\r\n\tconst { breadcrums, values, selectedValueNames, addValue, removeValue, includeAvailability=false, includeCost=false, allowNewValues: allowNewItems=false, createValue, allowMultiSelection=false } = props;\r\n\t\r\n\tconst classes = useStyles();\r\n\r\n\tconst [open, setOpen] = useState(false);\r\n\tconst onOpen = () => setOpen(true);\r\n\tconst onClose = () => setOpen(false);\r\n\r\n\tconst title = breadcrums.join(\" - \");\r\n\r\n\tconst items = values.map(v => createSelectableItem(v, selectedValueNames, includeAvailability, includeCost));\r\n\r\n\tconst onItemSelectionChange = (item: SelectableItem) => {\r\n\t\tconst { Name, Availability, Cost, selected } = item;\r\n\t\tif (selected) {\r\n\t\t\taddValue(Name);\r\n\t\t\tif (values.find(v => findName(v) === Name) === undefined) {\r\n\t\t\t\t// new item\r\n\t\t\t\tconst value = { Name, Availability, Cost };\r\n\t\t\t\tif (!createValue) {\r\n\t\t\t\t\tthrow new Error(`Attempting to create new item '${JSON.stringify(value)}' with no createValue prop`);\r\n\t\t\t\t}\r\n\t\t\t\tcreateValue(value);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tremoveValue(Name);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<IconButton aria-label=\"add\" onClick={onOpen} color=\"secondary\" size=\"medium\" className={classes.editButton} disableRipple>\r\n\t\t\t\t<EditIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t<PickerDialog\r\n\t\t\t\topen={open}\r\n\t\t\t\tonClose={onClose}\r\n\t\t\t\ttitle={title}\r\n\t\t\t\titems={items}\r\n\t\t\t\tonItemSelectionChange={onItemSelectionChange}\r\n\t\t\t\tincludeAvailability={includeAvailability}\r\n\t\t\t\tincludeCost={includeCost}\r\n\t\t\t\tallowNewItems={allowNewItems}\r\n\t\t\t\tallowMultiSelection={allowMultiSelection}\r\n\t\t\t/>\r\n\t\t</Fragment>\r\n\t);\r\n};\r\n\r\nexport default PickerButton;","import React, { FC } from \"react\";\r\n\r\nimport Slider from \"@material-ui/core/Slider\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\n\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport { NamedProperty } from \"../model/character\";\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n        display: \"flex\",\r\n        height: 50,\r\n    },\r\n    name: {\r\n        width: 200\r\n    },\r\n    slider: {\r\n        width: 300,\r\n        marginRight: 10,\r\n    },\r\n});\r\n\r\ntype Props = {\r\n    property: NamedProperty;\r\n    onUpdate: (property: NamedProperty) => void;\r\n    min: number;\r\n    max: number;\r\n    step: number;\r\n    formatDisplayValue: (rating: number) => string;\r\n    computeCost: (rating: number) => number;\r\n};\r\n\r\nconst Property: FC<Props> = (props: Props) => {\r\n    const { property, onUpdate, min, max, step, formatDisplayValue, computeCost } = props;\r\n    const { name, rating } = property;\r\n\r\n    const classes = useStyles();\r\n\r\n    const handleChange = (e: React.ChangeEvent<any>, rating: number | number[]) => {\r\n        if (Array.isArray(rating)) {\r\n            throw new Error(`Property element '${e.target.id}' has an array of values instead of a single value: [${rating.join(\", \")}]`);\r\n        }\r\n        onUpdate({\r\n            name,\r\n            rating: rating\r\n        });\r\n    }\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <Typography gutterBottom className={classes.name}>{name}</Typography>\r\n            <div className={classes.slider}>\r\n                <Slider\r\n                    step={step}\r\n                    min={min}\r\n                    max={max}\r\n                    value={rating}\r\n                    marks\r\n                    valueLabelDisplay=\"on\"\r\n                    onChange={handleChange}\r\n                    valueLabelFormat={(value: number, _index: number) => formatDisplayValue(value)}\r\n                />\r\n            </div>\r\n            <Typography gutterBottom>({computeCost(rating)})</Typography>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Property;","import React, { FC } from \"react\";\r\n\r\nimport { Skill as SkillData } from \"../model/character\";\r\nimport Property from \"./Property\";\r\n\r\ntype Props = {\r\n    skill: SkillData;\r\n\tonUpdate: (skill: SkillData) => void;\r\n\tcomputeCost: (rating: number) => number;\r\n};\r\n\r\nconst Skill: FC<Props> = (props: Props) => {\r\n    const { skill, onUpdate, computeCost } = props;\r\n\r\n    return (\r\n        <Property\r\n            property={skill}\r\n            onUpdate={onUpdate}\r\n            min={1}\r\n            max={5}\r\n            step={2}\r\n            formatDisplayValue={value => value.toString()}\r\n            computeCost={computeCost}\r\n            />\r\n    );\r\n}\r\n\r\nexport default Skill;","import React, { FC, Fragment } from \"react\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\r\nimport ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\r\nimport ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\nimport { Skill as SkillData } from \"../model/character\";\r\nimport { CustomItem, getChildItems } from \"../model/custom-item\";\r\nimport { AddCustomItemData, ActionType } from \"../reducer\";\r\nimport { useDispatch, useGlobalState } from \"../context\";\r\nimport PickerButton from \"./PickerButton\";\r\nimport Skill from \"./Skill\";\r\n\r\nconst useStyles = makeStyles({\r\n    header: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        marginBottom: 20,\r\n        paddingLeft: 16,\r\n        paddingTop: 12,\r\n    },\r\n    headerLabel: {\r\n        lineHeight: 3,\r\n        fontWeight: 700,\r\n    },\r\n});\r\n\r\ntype Props = {\r\n    breadcrums: string[];\r\n\tskills: SkillData[];\r\n\tallSkills: CustomItem[];\r\n    headerLabel: string;\r\n    computeSkillCost: (rating: number) => number;\r\n\tonSkillsUpdated: (updatedSkills: SkillData[]) => void;\r\n};\r\nconst SkillList: FC<Props> = (props: Props) => {\r\n\tconst { breadcrums, skills, allSkills, headerLabel, computeSkillCost, onSkillsUpdated } = props;\r\n\r\n    const classes = useStyles();\r\n    const dispatch = useDispatch();\r\n    const customItems = useGlobalState(\"customItems\");\r\n\r\n    skills.sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n    const parentPath = breadcrums.join(\".\");\r\n    allSkills.push(...getChildItems(customItems, parentPath));\r\n    allSkills.sort((a, b) => a.Name.localeCompare(b.Name));\r\n\r\n    const onSkillUpdate = (skill: SkillData) => {\r\n        const newSkills = [ ...skills ];\r\n        const skillIndex = skills.findIndex(s => s.name === skill.name);\r\n        if (skillIndex > -1) {\r\n            if (skill.rating > 0) {\r\n                newSkills[skillIndex] = skill;\r\n            } else {\r\n                newSkills.splice(skillIndex, 1);\r\n            }\r\n        } else if (skill.rating > 0) {\r\n            newSkills.push(skill);\r\n        }\r\n        onSkillsUpdated(newSkills);\r\n    };\r\n    \r\n    const addSkill = (name: string) => {\r\n        onSkillUpdate({ name, rating: 1 });\r\n    };\r\n\r\n    const removeSkill = (name: string) => {\r\n        onSkillUpdate({ name, rating: -1 });\r\n    };\r\n\r\n    const createNewSkill = (item: CustomItem) => {\r\n        const path = `${parentPath}.${item.Name}`;\r\n        const data: AddCustomItemData = { path, item: item };\r\n        dispatch({ type: ActionType.AddCustomItem, data });\r\n    };\r\n\r\n\treturn (\r\n        <Fragment>\r\n            <ExpansionPanel defaultExpanded={false}>\r\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\r\n                    <FormControlLabel\r\n                        onClick={(event) => event.stopPropagation()}\r\n                        onFocus={(event) => event.stopPropagation()}\r\n                        control={<PickerButton\r\n                            breadcrums={breadcrums}\r\n                            values={allSkills}\r\n                            selectedValueNames={skills.map(s => s.name)}\r\n                            addValue={addSkill}\r\n                            removeValue={removeSkill}\r\n                            allowNewValues\r\n                            createValue={createNewSkill}\r\n                        />}\r\n                        label=\"\"\r\n                    />\r\n                    <Typography className={classes.headerLabel}>{headerLabel}</Typography>\r\n                </ExpansionPanelSummary>\r\n                <ExpansionPanelDetails>\r\n                    <List>\r\n                    {\r\n                        skills.map(s => (\r\n                            <ListItem key={s.name}>\r\n                                <Skill skill={s} onUpdate={onSkillUpdate} computeCost={computeSkillCost} />\r\n                            </ListItem>\r\n                        ))\r\n                    }\r\n                    </List>\r\n                </ExpansionPanelDetails>\r\n            </ExpansionPanel>\r\n        </Fragment>\r\n\t);\r\n};\r\n\r\nexport default SkillList;","import React, { FC } from \"react\";\r\nimport { useDispatch, useGlobalState } from \"../context\"\r\nimport { Skill as SkillData } from \"../model/character\";\r\nimport { ActionType, UpdateCharacterData } from \"../reducer\";\r\nimport { getActiveSkillsCost, getActiveSkillCost } from \"../model/skills\";\r\nimport SkillList from \"./SkillList\";\r\n\r\nconst breadcrums = [\"Skills\", \"Active\"];\r\n\r\nconst ActiveSkillList: FC = () => {\r\n    const dispatch = useDispatch();\r\n    const character = useGlobalState(\"selectedCharacter\");\r\n    const allSkills = useGlobalState(\"allSkills\");\r\n\r\n    const { activeSkills } = character;\r\n\r\n    const activeSkillsCost = getActiveSkillsCost(activeSkills);\r\n    const headerLabel = `Active Skills (${activeSkillsCost})`;\r\n\r\n    const allActiveSkills = [...allSkills.active];\r\n\r\n    const onSkillsUpdated = (activeSkills: SkillData[]) => {\r\n        const data: UpdateCharacterData = { ...character, activeSkills };\r\n        dispatch({ type: ActionType.UpdateCharacter, data });\r\n    }\r\n    return (\r\n        <SkillList\r\n            breadcrums={breadcrums}\r\n            skills={activeSkills}\r\n            allSkills={allActiveSkills}\r\n            headerLabel={headerLabel}\r\n            computeSkillCost={getActiveSkillCost}\r\n            onSkillsUpdated={onSkillsUpdated}\r\n        />\r\n    );\r\n}\r\n\r\nexport default ActiveSkillList;","import React, { FC } from \"react\";\r\nimport { useDispatch, useGlobalState } from \"../context\"\r\nimport { Skill as SkillData } from \"../model/character\";\r\nimport { ActionType, UpdateCharacterData } from \"../reducer\";\r\nimport { getKnowledgeSkillsCost, getFreeKnowledgeSkillPoints, getKnowledgeSkillCost } from \"../model/skills\";\r\nimport SkillList from \"./SkillList\";\r\n\r\nconst breadcrums = [\"Skills\", \"Knowledge\"];\r\n\r\nconst KnowledgeSkillList: FC = () => {\r\n    const dispatch = useDispatch();\r\n    const character = useGlobalState(\"selectedCharacter\");\r\n\tconst allSkills = useGlobalState(\"allSkills\");\r\n\r\n\tconst { knowledgeSkills } = character;\r\n\r\n\tconst knowledgeSkillsCost = getKnowledgeSkillsCost(knowledgeSkills);\r\n    const freeKnowledgeSkillPoints = getFreeKnowledgeSkillPoints(character);\r\n    const totalCost = knowledgeSkillsCost - freeKnowledgeSkillPoints;\r\n    const headerLabel = `Knowledge Skills (${knowledgeSkillsCost} - ${freeKnowledgeSkillPoints} = ${totalCost})`;\r\n\r\n    const allKnowledgeSkills = [...allSkills.knowledge];\r\n\r\n    const onSkillsUpdated = (knowledgeSkills: SkillData[]) => {\r\n        const data: UpdateCharacterData = { ...character, knowledgeSkills };\r\n        dispatch({ type: ActionType.UpdateCharacter, data });\r\n    };\r\n\r\n    return (\r\n        <SkillList\r\n            breadcrums={breadcrums}\r\n            skills={knowledgeSkills}\r\n            allSkills={allKnowledgeSkills}\r\n            headerLabel={headerLabel}\r\n            computeSkillCost={getKnowledgeSkillCost}\r\n            onSkillsUpdated={onSkillsUpdated}\r\n        />\r\n    );\r\n}\r\n\r\nexport default KnowledgeSkillList;","import React, { FC } from \"react\";\r\nimport { useDispatch, useGlobalState } from \"../context\"\r\nimport { Skill as SkillData } from \"../model/character\";\r\nimport { ActionType, UpdateCharacterData } from \"../reducer\";\r\nimport { getKnowledgeSkillsCost, getKnowledgeSkillCost } from \"../model/skills\";\r\nimport SkillList from \"./SkillList\";\r\n\r\nconst breadcrums = [\"Skills\", \"Language\"];\r\n\r\nconst LanguageSkillList: FC = () => {\r\n    const dispatch = useDispatch();\r\n    const character = useGlobalState(\"selectedCharacter\");\r\n\tconst allSkills = useGlobalState(\"allSkills\");\r\n\r\n\tconst { languageSkills } = character;\r\n\r\n\tconst languageSkillsCost = getKnowledgeSkillsCost(languageSkills);\r\n    const headerLabel = `Language Skills (${languageSkillsCost}) + Native`;\r\n\r\n    const allLanguageSkills = [...allSkills.language];\r\n\r\n    const onSkillsUpdated = (languageSkills: SkillData[]) => {\r\n        const data: UpdateCharacterData = { ...character, languageSkills };\r\n        dispatch({ type: ActionType.UpdateCharacter, data });\r\n    };\r\n\r\n    return (\r\n        <SkillList\r\n            breadcrums={breadcrums}\r\n            skills={languageSkills}\r\n            allSkills={allLanguageSkills}\r\n            headerLabel={headerLabel}\r\n            computeSkillCost={getKnowledgeSkillCost}\r\n            onSkillsUpdated={onSkillsUpdated}\r\n        />\r\n    );\r\n}\r\n\r\nexport default LanguageSkillList;","import React, { FC, Fragment } from \"react\";\r\nimport ActiveSkillList from \"./ActiveSkillList\";\r\nimport KnowledgeSkillList from \"./KnowledgeSkillList\";\r\nimport LanguageSkillList from \"./LanguageSkillList\";\r\n\r\nconst SkillsTab: FC = () => {\r\n    return (\r\n        <Fragment>\r\n            <ActiveSkillList />\r\n            <KnowledgeSkillList />\r\n            <LanguageSkillList />\r\n        </Fragment>\r\n    )\r\n};\r\n\r\nexport default SkillsTab;","import React, { FC, Fragment } from \"react\";\r\nimport Badge from \"@material-ui/core/Badge\";\r\nimport ShoppingCartIcon from \"@material-ui/icons/ShoppingCart\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { useGlobalState } from \"../context\";\r\n\r\nconst useStyles = makeStyles({\r\n    badge: {\r\n        marginLeft: 50,\r\n    },\r\n});\r\n\r\nconst Karma: FC = () => {\r\n    const classes = useStyles();\r\n    const karma = useGlobalState(\"karma\");\r\n    const { total, spent, available } = karma;\r\n    return (\r\n        <Fragment>\r\n            <Badge className={classes.badge} badgeContent={total} color=\"primary\" max={999} showZero>\r\n                <ShoppingCartIcon />\r\n            </Badge>\r\n            <Badge className={classes.badge} badgeContent={spent} color=\"secondary\" max={999} showZero>\r\n                <ShoppingCartIcon />\r\n            </Badge>\r\n            <Badge className={classes.badge} badgeContent={available} color=\"primary\" max={999} showZero>\r\n                <ShoppingCartIcon />\r\n            </Badge>\r\n        </Fragment>\r\n    );\r\n};\r\n\r\nexport default Karma;","import React, { FC } from \"react\";\r\n\r\nimport { Attribute as AttributeData, MetaType } from \"../model/character\";\r\nimport { getAttributeModifier, getAttributeCost } from \"../model/attributes\";\r\nimport Property from \"./Property\";\r\n\r\ntype Props = {\r\n    attribute: AttributeData;\r\n    metaType: MetaType;\r\n    onUpdate: (attribute: AttributeData) => void;\r\n};\r\n\r\nconst Attribute: FC<Props> = (props: Props) => {\r\n    const { attribute, metaType, onUpdate } = props;\r\n    const modifier = getAttributeModifier(metaType, attribute);\r\n\r\n    const formatDisplayValue = (rating: number): string => (rating + modifier).toString();\r\n\r\n    return (\r\n        <Property property={attribute} onUpdate={onUpdate} min={1} max={7} step={1} formatDisplayValue={formatDisplayValue} computeCost={getAttributeCost} />\r\n    );\r\n};\r\n\r\nexport default Attribute;","import React, { FC, Fragment } from \"react\";\r\nimport { useDispatch, useGlobalState } from \"../context\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Attribute from \"./Attribute\";\r\nimport { Attribute as AttributeData, isAwakened } from \"../model/character\";\r\nimport { ActionType } from \"../reducer\";\r\nimport { getAttributesCost } from \"../model/attributes\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles({\r\n    header: {\r\n        marginBottom: 20,\r\n        paddingLeft: 16,\r\n        paddingTop: 12,\r\n        fontWeight: 700,\r\n    }\r\n});\r\n\r\nconst AttributeList: FC = () => {\r\n    const dispatch = useDispatch();\r\n    const character = useGlobalState(\"selectedCharacter\");\r\n    const classes = useStyles();\r\n\r\n    const { attributes, metaType } = character;\r\n\r\n    const filteredAttributes = attributes.filter(a => isAwakened(character) || a.name !== \"Magic\");\r\n\r\n    const attributesCost = getAttributesCost(character);\r\n\r\n    const onUpdate = (attribute: AttributeData) => {\r\n        const newAttributes = [ ...attributes ];\r\n        const attributeIndex = newAttributes.findIndex(a => a.name === attribute.name);\r\n        newAttributes[attributeIndex] = attribute;\r\n        dispatch({\r\n            type: ActionType.UpdateCharacter,\r\n            data: { ...character, attributes: newAttributes }\r\n        });\r\n    };\r\n    return (\r\n        <Fragment>\r\n            <Typography className={classes.header}>Attributes ({attributesCost})</Typography>\r\n            <List>\r\n                {\r\n                    filteredAttributes.map(a => (\r\n                        <ListItem key={a.name}>\r\n                            <Attribute attribute={a} metaType={metaType} onUpdate={onUpdate} />\r\n                        </ListItem>\r\n                    ))\r\n                }\r\n            </List>\r\n        </Fragment>\r\n    );\r\n};\r\n\r\nexport default AttributeList;","import React, { FC } from \"react\";\r\nimport AttributeList from \"./AttributeList\";\r\n\r\nconst AttributesTab: FC = () => {\r\n\treturn (\r\n\t\t<AttributeList />\r\n\t);\r\n};\r\n\r\nexport default AttributesTab;","import { Character } from \"./character\";\r\n\r\nexport type Contact = {\r\n\tname: string;\r\n\tconnection: number;\r\n\tloyalty: number;\r\n};\r\n\r\nexport function getContactRatingCost(rating: number): number {\r\n\tswitch (rating) {\r\n\t\tcase 1:\r\n\t\t\treturn 2;\r\n\t\tcase 3:\r\n\t\t\treturn 7;\r\n\t\tcase 5:\r\n\t\t\treturn 15;\r\n\t\tdefault:\r\n\t\t\tthrow new Error();\r\n\t}\r\n}\r\n\r\nexport function getContactCost(contact: Contact): number {\r\n\tlet cost = 0;\r\n\tcost += getContactRatingCost(contact.connection);\r\n\tcost += getContactRatingCost(contact.loyalty);\r\n\treturn cost;\r\n}\r\n\r\nexport function getFreeContactPoints(character: Character): number {\r\n    const charisma = character.attributes.find(a => a.name === \"Charisma\");\r\n    if (charisma === undefined) {\r\n        throw new Error(`Character '${character.streetName}' has no attribute 'Charisma'`);\r\n    }\r\n    const willpower = character.attributes.find(a => a.name === \"Willpower\");\r\n    if (willpower === undefined) {\r\n        throw new Error(`Character '${character.streetName}' has no attribute 'Willpower'`);\r\n    }\r\n    return (charisma.rating + willpower.rating) * 10;\r\n}\r\n\r\nexport function getAllContactsCost(character: Character): number {\r\n\treturn character.contacts.map(c => getContactCost(c)).reduce((a, b) => a + b, 0);\r\n}","import React, { FC, Fragment } from \"react\";\r\nimport ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\r\nimport ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\r\nimport ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\nimport { Contact as ContactData, getContactCost, getContactRatingCost } from \"../model/contact\";\r\nimport Property from \"./Property\";\r\nimport { NamedProperty } from \"../model/character\";\r\n\r\nconst useStyles = makeStyles({\r\n\theaderLabel: {\r\n\t\tfontWeight: 700,\r\n\t},\r\n\tdetails: {\r\n\t\tdisplay: \"flex\",\r\n\t\tflexDirection: \"column\",\r\n\t},\r\n\trating: {\r\n\t\tmarginTop: 30,\r\n\t}\r\n});\r\n\r\ntype Props = {\r\n\tcontact: ContactData;\r\n\tonUpdate: (contact: ContactData) => void;\r\n};\r\nconst Contact: FC<Props> = (props: Props) => {\r\n\tconst { contact, onUpdate } = props;\r\n\r\n\tconst classes = useStyles();\r\n\r\n\tconst contactCost = getContactCost(contact);\r\n\r\n\tconst connection: NamedProperty = { name: \"Connection\", rating: contact.connection };\r\n\tconst onUpdateConnection = (updatedConnection: NamedProperty) => {\r\n\t\tconst updatedContact = { ...contact, connection: updatedConnection.rating };\r\n\t\tonUpdate(updatedContact);\r\n\t};\r\n\tconst loyalty: NamedProperty = { name: \"Loyalty\", rating: contact.loyalty };\r\n\tconst onUpdateLoyalty = (updatedLoyalty: NamedProperty) => {\r\n\t\tconst updatedContact = { ...contact, loyalty: updatedLoyalty.rating };\r\n\t\tonUpdate(updatedContact);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<ExpansionPanel defaultExpanded={false}>\r\n\t\t\t\t<ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\r\n\t\t\t\t\t<Typography className={classes.headerLabel}>{contact.name} ({contactCost})</Typography>\r\n\t\t\t\t</ExpansionPanelSummary>\r\n\t\t\t\t<ExpansionPanelDetails>\r\n\t\t\t\t\t<div className={classes.details}>\r\n\t\t\t\t\t\t<div className={classes.rating}>\r\n\t\t\t\t\t\t\t<Property\r\n\t\t\t\t\t\t\t\tproperty={connection}\r\n\t\t\t\t\t\t\t\tonUpdate={onUpdateConnection}\r\n\t\t\t\t\t\t\t\tmin={1}\r\n\t\t\t\t\t\t\t\tmax={3}\r\n\t\t\t\t\t\t\t\tstep={2}\r\n\t\t\t\t\t\t\t\tformatDisplayValue={(value => value.toString())}\r\n\t\t\t\t\t\t\t\tcomputeCost={getContactRatingCost}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className={classes.rating}>\r\n\t\t\t\t\t\t\t<Property\r\n\t\t\t\t\t\t\t\tproperty={loyalty}\r\n\t\t\t\t\t\t\t\tonUpdate={onUpdateLoyalty}\r\n\t\t\t\t\t\t\t\tmin={1}\r\n\t\t\t\t\t\t\t\tmax={5}\r\n\t\t\t\t\t\t\t\tstep={2}\r\n\t\t\t\t\t\t\t\tformatDisplayValue={(value => value.toString())}\r\n\t\t\t\t\t\t\t\tcomputeCost={getContactRatingCost}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</ExpansionPanelDetails>\r\n\t\t\t</ExpansionPanel>\r\n\t\t</Fragment>\r\n\t);\r\n}\r\n\r\nexport default Contact;","import React, { FC, Fragment } from \"react\";\r\nimport List from \"@material-ui/core/List\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\nimport PickerButton from \"./PickerButton\";\r\nimport Contact from \"./Contact\";\r\nimport { useDispatch, useGlobalState } from \"../context\";\r\nimport { Contact as ContactData, getAllContactsCost, getFreeContactPoints } from \"../model/contact\";\r\nimport { UpdateCharacterData, ActionType, AddCustomItemData } from \"../reducer\";\r\nimport { getChildItems, CustomItem } from \"../model/custom-item\";\r\n\r\nconst useStyles = makeStyles({\r\n\theader: {\r\n\t\tdisplay: \"flex\",\r\n\t\tflexDirection: \"row\",\r\n\t},\r\n\theaderLabel: {\r\n\t\tlineHeight: 3,\r\n\t\tfontWeight: 700,\r\n\t},\r\n});\r\n\r\nconst breadcrums = [\"Contacts\"];\r\nconst parentPath = breadcrums.join(\".\");\r\n\r\nconst ContactList: FC = () => {\r\n\tconst classes = useStyles();\r\n\tconst dispatch = useDispatch();\r\n\tconst character = useGlobalState(\"selectedCharacter\");\r\n\tconst allContacts = useGlobalState(\"allContacts\");\r\n\tconst customItems = useGlobalState(\"customItems\");\r\n\tconst { contacts: selectedContacts } = character;\r\n\r\n\tselectedContacts.sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n\tconst contactsCost = getAllContactsCost(character);\r\n\tconst freeContactPoints = getFreeContactPoints(character);\r\n    const totalCost = contactsCost - freeContactPoints;\r\n\tconst headerLabel = `Contacts (${contactsCost} - ${freeContactPoints} = ${totalCost})`;\r\n\t\r\n\tallContacts.push(...getChildItems(customItems, parentPath));\r\n    allContacts.sort((a, b) => a.Name.localeCompare(b.Name));\r\n\r\n\tconst onContactUpdate = (contact: ContactData) => {\r\n\t\tconst newContacts = [...selectedContacts];\r\n\t\tconst contactIndex = selectedContacts.findIndex(s => s.name === contact.name);\r\n\t\tif (contactIndex > -1) {\r\n\t\t\tif (contact.connection > 0 && contact.loyalty > 0) {\r\n\t\t\t\tnewContacts[contactIndex] = contact;\r\n\t\t\t} else {\r\n\t\t\t\tnewContacts.splice(contactIndex, 1);\r\n\t\t\t}\r\n\t\t} else if (contact.connection > 0 && contact.loyalty > 0) {\r\n\t\t\tnewContacts.push(contact);\r\n\t\t}\r\n\t\tconst data: UpdateCharacterData = { ...character, contacts: newContacts };\r\n\t\tdispatch({ type: ActionType.UpdateCharacter, data });\r\n\t};\r\n\r\n\tconst addContact = (name: string) => {\r\n\t\tonContactUpdate({ name, connection: 1, loyalty: 1 });\r\n\t};\r\n\r\n\tconst removeContact = (name: string) => {\r\n\t\tonContactUpdate({ name, connection: -1, loyalty: -1 });\r\n\t};\r\n\r\n\tconst createNewContact = (item: CustomItem) => {\r\n        const path = `${parentPath}.${item.Name}`;\r\n        const data: AddCustomItemData = { path, item: item };\r\n        dispatch({ type: ActionType.AddCustomItem, data });\r\n    };\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<div className={classes.header}>\r\n\t\t\t\t<PickerButton\r\n\t\t\t\t\tbreadcrums={breadcrums}\r\n\t\t\t\t\tvalues={allContacts}\r\n\t\t\t\t\tselectedValueNames={selectedContacts.map(s => s.name)}\r\n\t\t\t\t\taddValue={addContact}\r\n\t\t\t\t\tremoveValue={removeContact}\r\n\t\t\t\t\tallowNewValues\r\n\t\t\t\t\tcreateValue={createNewContact}\r\n\t\t\t\t/>\r\n\t\t\t\t<Typography className={classes.headerLabel}>{headerLabel}</Typography>\r\n\t\t\t</div>\r\n\t\t\t<List>\r\n\t\t\t\t{\r\n\t\t\t\t\tselectedContacts.map(c => (\r\n\t\t\t\t\t\t<Contact key={c.name} contact={c} onUpdate={onContactUpdate} />\r\n\t\t\t\t\t))\r\n\t\t\t\t}\r\n\t\t\t\t</List>\r\n\t\t</Fragment>\r\n\t);\r\n}\r\n\r\nexport default ContactList;","import React, { FC } from \"react\";\r\nimport ContactList from \"./ContactList\";\r\n\r\nconst ContactsTab: FC = () => {\r\n\treturn (\r\n\t\t<ContactList />\r\n\t);\r\n}\r\n\r\nexport default ContactsTab;","import React, { FC } from \"react\";\r\nimport { useGlobalState, useDispatch } from \"../context\";\r\nimport { ActionType, UpdateCharacterData } from \"../reducer\";\r\nimport { Item } from \"../model/item\";\r\nimport GroupContainer from \"./GroupContainer\";\r\n\r\nconst MagicTab: FC = () => {\r\n\tconst dispatch = useDispatch();\r\n\tconst character = useGlobalState(\"selectedCharacter\");\r\n\tconst { spells } = character;\r\n\tconst allSpells = useGlobalState(\"allSpells\");\r\n\r\n\tconst createSpellCostLabel = (_item: Item) => {\r\n\t\treturn \"5\";\r\n\t};\r\n\r\n\tconst createSpellLabel = (item: Item) => {\r\n\t\tconst { name } = item;\r\n\t\treturn `${name} (5)`;\r\n\t};\r\n\r\n\tconst handleUpdateSpells = (newSpells: Item[]) => {\r\n\t\tconst data: UpdateCharacterData = { ...character, spells: newSpells };\r\n\t\tdispatch({ type: ActionType.UpdateCharacter, data });\r\n\t};\r\n\treturn (\r\n\t\t<GroupContainer\r\n\t\t\tlabel=\"Spells\"\r\n\t\t\titems={spells}\r\n\t\t\tallItems={allSpells}\r\n\t\t\tcreateItemLabel={createSpellLabel}\r\n\t\t\tcreateItemCostLabel={createSpellCostLabel}\r\n\t\t\tonUpdateItems={handleUpdateSpells}\r\n\t\t/>\r\n\t);\r\n};\r\n\r\nexport default MagicTab;","import React, { FC, Fragment } from \"react\";\r\nimport { useGlobalState, useDispatch } from \"../context\";\r\nimport { ActionType, UpdateCharacterData } from \"../reducer\";\r\nimport { getChildNames, getChildSet } from \"../model/dictionary\";\r\nimport GroupContainer from \"./GroupContainer\";\r\nimport { Item, getItemSubset } from \"../model/item\";\r\nimport { sentenceCase } from \"change-case\";\r\nimport { gearRoot, computeItemCost, Grade } from \"../model/gear\";\r\n\r\nconst GearTab: FC = () => {\r\n\tconst dispatch = useDispatch();\r\n\tconst character = useGlobalState(\"selectedCharacter\");\r\n\tconst { gear } = character;\r\n\tconst allGear = useGlobalState(\"allGear\");\r\n\r\n\tconst createGearCostLabel = (item: Item) => {\r\n\t\tconst cost = computeItemCost(item, allGear);\r\n\t\treturn `${cost}`;\r\n\t};\r\n\r\n\tconst createGearLabel= (item: Item) => {\r\n\t\tconst { name } = item;\r\n\t\tconst costLabel = createGearCostLabel(item);\r\n\t\tlet label = `${name} (${costLabel})`;\r\n\t\tconst includeGrade = item.path.startsWith(`${gearRoot}.augmentations`);\r\n\t\tif (includeGrade) {\r\n\t\t\tlabel += ` [${item.grade || Grade.Alpha}]`;\r\n\t\t}\r\n\t\treturn label;\r\n\t};\r\n\r\n\tconst handleUpdateGear = (name: string, newSubGear: Item[]) => {\r\n\t\tconst newGear = gear.filter(g => !g.path.startsWith(`${gearRoot}.${name}`));\r\n\t\tnewGear.push(...newSubGear);\r\n\t\tconst data: UpdateCharacterData = { ...character, gear: newGear };\r\n\t\tdispatch({ type: ActionType.UpdateCharacter, data });\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t{\r\n\t\t\t\tgetChildNames(allGear, gearRoot).map(name =>\r\n\t\t\t\t\t<GroupContainer\r\n\t\t\t\t\t\tkey={name}\r\n\t\t\t\t\t\tlabel={sentenceCase(name)}\r\n\t\t\t\t\t\titems={getItemSubset(gear, `${gearRoot}.${name}`)}\r\n\t\t\t\t\t\tallItems={getChildSet(allGear, `${gearRoot}.${name}`)}\r\n\t\t\t\t\t\tcreateItemLabel={createGearLabel}\r\n\t\t\t\t\t\tcreateItemCostLabel={createGearCostLabel}\r\n\t\t\t\t\t\tonUpdateItems={newItems => handleUpdateGear(name, newItems)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t</Fragment>\r\n\t);\r\n};\r\n\r\nexport default GearTab;","import { Character } from \"./character\";\r\nimport { Item } from \"./item\";\r\nimport { Dictionary, transformAllItems } from \"./dictionary\";\r\n\r\nexport type Spell = {\r\n\tcost: string;\r\n} & Item;\r\n\r\nexport const spellsRoot = \"spells\";\r\n\r\nexport function transformAllSpells(allData: any): Dictionary<Spell[]> {\r\n\tconst allSpells: Dictionary<Spell[]> = {};\r\n\ttransformAllItems(spellsRoot, allData, allSpells, transformSpellValues);\r\n\treturn allSpells;\r\n}\r\n\r\nfunction transformSpellValues(path: string, values: any[]): Spell[] {\r\n\tconst spells: Spell[] = []\r\n\tfor (const value of values) {\r\n\t\tconst name = value[\"Name\"];\r\n\t\tspells.push({ path, name, cost: \"5\" });\r\n\t}\r\n\treturn spells;\r\n}\r\n\r\nexport function getSpellsCost(spells: Item[]): number {\r\n\treturn spells.length * 5;\r\n}\r\n\r\nexport function getCharacterSpellsCost(character: Character): number {\r\n\treturn getSpellsCost(character.spells);\r\n}","import React, { FC } from \"react\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\troot: {\r\n\t\tdisplay: \"flex\",\r\n\t\tflexDirection: \"row\",\r\n\t\tmarginLeft: 10,\r\n\t\tmarginTop: 10,\r\n\t},\r\n\tname: {\r\n\t\tlineHeight: \"40px\"\r\n\t},\r\n\tvalue: {\r\n\t\tmarginLeft: 5,\r\n\t\tcolor: theme.palette.getContrastText(theme.palette.primary.main),\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t}\r\n}));\r\n\r\ntype Props = {\r\n\tname: string;\r\n\tvalue: number;\r\n}\r\nconst ReadOnlyProperty: FC<Props> = (props: Props) => {\r\n\tconst { name, value } = props;\r\n\r\n\tconst classes = useStyles();\r\n\r\n\treturn (\r\n\t\t<div className={classes.root}>\r\n\t\t\t<Typography className={classes.name}>{name}</Typography>\r\n\t\t\t<Avatar className={classes.value}>{value}</Avatar>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ReadOnlyProperty;","import React, { FC, Fragment } from \"react\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport { useGlobalState } from \"../context\";\r\nimport { getEffectiveAttributeRating } from \"../model/attributes\";\r\nimport ReadOnlyProperty from \"./ReadOnlyProperty\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\nimport { MetaType } from \"../model/character\";\r\n\r\nconst useStyles = makeStyles({\r\n\theader: {\r\n\t\tmarginTop: 10,\r\n\t\tmarginLeft: 5,\r\n\t},\r\n\tsection: {\r\n\t\tdisplay: \"flex\",\r\n\t\tflexDirection: \"row\",\r\n\t\tmarginBottom: 10,\r\n\t},\r\n})\r\n\r\nconst CombatTab: FC = () => {\r\n\r\n\tconst classes = useStyles();\r\n\r\n\tconst character = useGlobalState(\"selectedCharacter\");\r\n\r\n\tconst body = getEffectiveAttributeRating(character, \"Body\");\r\n\tconst agility = getEffectiveAttributeRating(character, \"Agility\");\r\n\tconst reaction = getEffectiveAttributeRating(character, \"Reaction\");\r\n\tconst intuition = getEffectiveAttributeRating(character, \"Intuition\");\r\n\tconst willpower = getEffectiveAttributeRating(character, \"Willpower\");\r\n\r\n\tconst athletics = character.activeSkills.find(s => s.name === \"Athletics\")?.rating || 0;\r\n\r\n\tconst initiative = reaction + intuition;\r\n\tconst initiativePasses = 1;\r\n\r\n\tconst physicalBoxes = 8 + Math.ceil(body / 2);\r\n\tconst stunBoxes = 8 + Math.ceil(willpower / 2);\r\n\r\n\tlet sneaking = agility;\r\n\tif (character.metaType !== MetaType.Dwarf) {\r\n\t\tsneaking += 1;\r\n\t}\r\n\r\n\tlet walking = sneaking + athletics;\r\n\tif (character.metaType !== MetaType.Dwarf) {\r\n\t\twalking += 2;\r\n\t}\r\n\r\n\tconst running = walking * 2;\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<Typography className={classes.header}>Initiative</Typography>\r\n\t\t\t<Divider />\r\n\t\t\t<div className={classes.section}>\r\n\t\t\t\t<ReadOnlyProperty name=\"Initiative\" value={initiative} />\r\n\t\t\t\t<ReadOnlyProperty name=\"Initiative Passes\" value={initiativePasses} />\r\n\t\t\t</div>\r\n\t\t\t<Typography className={classes.header}>Condition Monitor</Typography>\r\n\t\t\t<Divider />\r\n\t\t\t<div className={classes.section}>\r\n\t\t\t\t<ReadOnlyProperty name=\"Physical Boxes\" value={physicalBoxes} />\r\n\t\t\t\t<ReadOnlyProperty name=\"Stun Boxes\" value={stunBoxes} />\r\n\t\t\t</div>\r\n\t\t\t<Typography className={classes.header}>Movement</Typography>\r\n\t\t\t<Divider />\r\n\t\t\t<div className={classes.section}>\r\n\t\t\t\t<ReadOnlyProperty name=\"Sneaking\" value={sneaking} />\r\n\t\t\t\t<ReadOnlyProperty name=\"Walking\" value={walking} />\r\n\t\t\t\t<ReadOnlyProperty name=\"Running\" value={running} />\r\n\t\t\t</div>\r\n\t\t</Fragment>\r\n\t);\r\n};\r\n\r\nexport default CombatTab;","import React, { FC, useState, useEffect } from \"react\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Badge from \"@material-ui/core/Badge\";\r\nimport Drawer from \"@material-ui/core/Drawer\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport SaveIcon from \"@material-ui/icons/Save\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport SelectCharacter from \"./SelectCharacter\";\r\nimport CharacterName from \"./CharacterName\";\r\nimport { useDispatch, useGlobalState } from \"../context\";\r\nimport { ActionType, LoadSkillsData, LoadContactsData, LoadQualitiesData, LoadSpellsData, LoadGearData } from \"../reducer\";\r\nimport CharacterTab from \"./CharacterTab\";\r\nimport SkillsTab from \"./SkillsTab\";\r\nimport Karma from \"./Karma\";\r\nimport AttributesTab from \"./AttributesTab\";\r\nimport ContactsTab from \"./ContactsTab\";\r\nimport { isAwakened } from \"../model/character\";\r\nimport MagicTab from \"./MagicTab\";\r\nimport GearTab from \"./GearTab\";\r\nimport { transformAllGear, getCharacterGearNuyenCost, getCharacterGearKarmaCost } from \"../model/gear\";\r\nimport { getMetaTypeCost } from \"../model/meta-type\";\r\nimport { transformAllQualities, getCharacterQualitiesCost } from \"../model/quality\";\r\nimport { getAllContactsCost } from \"../model/contact\";\r\nimport { getCharacterSpellsCost, transformAllSpells } from \"../model/magic\";\r\nimport { getSkillsCost } from \"../model/skills\";\r\nimport { getAttributesCost } from \"../model/attributes\";\r\nimport CombatTab from \"./CombatTab\";\r\n\r\nconst useStyles = makeStyles({\r\n    bar: {\r\n        flexGrow: 1,\r\n        display: \"flex\",\r\n    }\r\n});\r\n\r\nconst CharacterCreator: FC = () => {\r\n    const classes = useStyles();\r\n    const dispatch = useDispatch();\r\n    const selectedCharacter = useGlobalState(\"selectedCharacter\");\r\n    const allQualities = useGlobalState(\"allQualities\");\r\n    const allGear = useGlobalState(\"allGear\");\r\n\r\n    const [drawerOpen, setDrawerOpen] = useState(false);\r\n    const [selectedTab, setSelectedTab] = useState(0);\r\n\r\n    useEffect(() => {\r\n        fetch(\"data/qualities.json\")\r\n            .then(response => response.json())\r\n            .then(qualities => {\r\n                const data = transformAllQualities(qualities) as LoadQualitiesData;\r\n                dispatch({ type: ActionType.LoadQualities, data });\r\n            })\r\n            .catch(error => {\r\n                console.error(`Error occured loading qualities: ${error.message}\\n${error.stack}`);\r\n            });\r\n        fetch(\"data/skills.json\")\r\n            .then(response => response.json())\r\n            .then(skills => {\r\n                const data = skills as LoadSkillsData;\r\n                dispatch({ type: ActionType.LoadSkills, data });\r\n            })\r\n            .catch(error => {\r\n                console.error(`Error occured loading skills: ${error.message}\\n${error.stack}`);\r\n            });\r\n        fetch(\"data/contacts.json\")\r\n            .then(response => response.json())\r\n            .then(contacts => {\r\n                const data = contacts.all as LoadContactsData;\r\n                dispatch({ type: ActionType.LoadContacts, data });\r\n            })\r\n            .catch(error => {\r\n                console.error(`Error occured loading contacts: ${error.message}\\n${error.stack}`);\r\n            });\r\n        fetch(\"data/magic.json\")\r\n            .then(response => response.json())\r\n            .then(magic => {\r\n                const spellData = transformAllSpells(magic.spells) as LoadSpellsData;\r\n                dispatch({ type: ActionType.LoadSpells, data: spellData });\r\n            })\r\n            .catch(error => {\r\n                console.error(`Error occured loading magic: ${error.message}\\n${error.stack}`);\r\n            });\r\n        fetch(\"data/gear.json\")\r\n            .then(response => response.json())\r\n            .then(gear => {\r\n                const gearData = transformAllGear(gear) as LoadGearData;\r\n                dispatch({ type: ActionType.LoadGear, data: gearData });\r\n            })\r\n            .catch(error => {\r\n                console.error(`Error occured loading gear: ${error.message}\\n${error.stack}`);\r\n            });\r\n    }, [dispatch]);\r\n\r\n    const saveClickHandler = () => {\r\n        dispatch({ type: ActionType.SaveCharacter });\r\n    };\r\n    const resetClickHandler = () =>{\r\n        dispatch({ type: ActionType.ClearCharacter });\r\n    };\r\n\r\n    const characterCost = getMetaTypeCost(selectedCharacter.metaType) + getCharacterQualitiesCost(selectedCharacter, allQualities);\r\n    const attributesCost = getAttributesCost(selectedCharacter);\r\n    const skillsCost = getSkillsCost(selectedCharacter);\r\n    const contactsCost = getAllContactsCost(selectedCharacter);\r\n    const magicCost = getCharacterSpellsCost(selectedCharacter);\r\n    const gearNuyenCost = getCharacterGearNuyenCost(selectedCharacter, allGear);\r\n    const getGearKarmaCost = getCharacterGearKarmaCost(gearNuyenCost);\r\n\r\n    let gearNuyenCostLabel: string;\r\n    if (gearNuyenCost < 1000) {\r\n        gearNuyenCostLabel = `${gearNuyenCost}`;\r\n    } else if (gearNuyenCost < 1000000) {\r\n        gearNuyenCostLabel = `${Math.round(gearNuyenCost / 100) / 10}K`;\r\n    } else {\r\n        gearNuyenCostLabel = `${Math.round(gearNuyenCost / 100000) / 10}M`;\r\n    }\r\n\r\n    const onTabChange = (_event: React.ChangeEvent<{}>, newValue: number) => {\r\n        setSelectedTab(newValue);\r\n    };\r\n\r\n    const awakened = isAwakened(selectedCharacter);\r\n\r\n    let selectedTabPanel: JSX.Element | null;\r\n    switch (selectedTab) {\r\n        case 0:\r\n            selectedTabPanel = <CharacterTab />;\r\n            break;\r\n        case 1:\r\n            selectedTabPanel = <AttributesTab />;\r\n            break;\r\n        case 2:\r\n            selectedTabPanel = <SkillsTab />;\r\n            break;\r\n        case 3:\r\n            selectedTabPanel = <ContactsTab />;\r\n            break;\r\n        case 4: {\r\n            selectedTabPanel = <GearTab />;\r\n            break;\r\n        }\r\n        case 5: {\r\n            selectedTabPanel = <MagicTab />;\r\n            break;\r\n        }\r\n        case 6: {\r\n            selectedTabPanel = <CombatTab />;\r\n            break;\r\n        }\r\n        default:\r\n            throw new Error(`Unknown tab index ${selectedTab}`);\r\n    }\r\n\r\n    const onMenuClick = () => {\r\n        setDrawerOpen(true);\r\n    }\r\n    const onDrawerClose = () => {\r\n        setDrawerOpen(false);\r\n    }\r\n    \r\n    return (\r\n        <div>\r\n            <AppBar position=\"sticky\" color=\"default\">\r\n                <Toolbar>\r\n                    <IconButton edge=\"start\" onClick={onMenuClick} aria-label=\"menu\">\r\n                        <MenuIcon />\r\n                    </IconButton>\r\n                    <div className={classes.bar}>\r\n                        <CharacterName character={selectedCharacter} />\r\n                        <Karma />\r\n                    </div>\r\n                    <IconButton aria-label=\"save\" onClick={saveClickHandler} color=\"secondary\">\r\n                        <SaveIcon />\r\n                    </IconButton>\r\n                    <IconButton aria-label=\"clear\" onClick={resetClickHandler} color=\"secondary\">\r\n                        <ClearIcon />\r\n                    </IconButton>\r\n                </Toolbar>\r\n                <Tabs value={selectedTab} onChange={onTabChange} variant=\"scrollable\">\r\n                    <Tab\r\n                        label={\r\n                            <Badge badgeContent={characterCost} color=\"default\" showZero max={999}>\r\n                                Character\r\n                            </Badge>\r\n                        }\r\n                    />\r\n                    <Tab\r\n                        label={\r\n                            <Badge badgeContent={attributesCost} color=\"default\" showZero max={999}>\r\n                                Attributes\r\n                            </Badge>\r\n                        }\r\n                    />\r\n                    <Tab\r\n                        label={\r\n                            <Badge badgeContent={skillsCost} color=\"default\" showZero max={999}>\r\n                                Skills\r\n                            </Badge>\r\n                        }\r\n                    />\r\n                    <Tab\r\n                        label={\r\n                            <Badge badgeContent={contactsCost} color=\"default\" showZero max={999}>\r\n                                Contacts\r\n                            </Badge>\r\n                        }\r\n                    />\r\n                    <Tab\r\n                        label={\r\n                            <Badge badgeContent={gearNuyenCostLabel} color=\"default\" showZero max={1000000} anchorOrigin={{ vertical: \"top\", horizontal: \"left\" }}>\r\n                                <Badge badgeContent={getGearKarmaCost} color=\"default\" showZero max={999} anchorOrigin={{ vertical: \"top\", horizontal: \"right\" }}>\r\n                                    Gear\r\n                                </Badge>\r\n                            </Badge>\r\n                        }\r\n                    />\r\n                    <Tab\r\n                        disabled={!awakened}\r\n                        label={\r\n                            <Badge badgeContent={magicCost} color=\"default\" showZero max={999}>\r\n                                Magic\r\n                            </Badge>\r\n                        }\r\n                    />\r\n                    <Tab label=\"Combat\" />\r\n                </Tabs>\r\n            </AppBar>\r\n            {\r\n                selectedTabPanel\r\n            }\r\n            <Drawer open={drawerOpen} onClose={onDrawerClose}>\r\n                <SelectCharacter />\r\n            </Drawer>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CharacterCreator;","import React, { FC, useReducer } from \"react\";\r\nimport { DispatchContext, StateContext } from \"./context\";\r\nimport { reducer, INITIAL_STATE } from \"./reducer\";\r\nimport { State } from \"./model/state\";\r\nimport { loadCharacter, loadCharacters, loadSelectedCharacter } from \"./persistance\";\r\nimport CharacterCreator from \"./component/CharacterCreator\";\r\nimport { createMuiTheme, ThemeProvider } from \"@material-ui/core/styles\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\n\r\nconst theme = createMuiTheme({\r\n    palette: {\r\n        type: \"dark\"\r\n    }\r\n});\r\n\r\nconst App: FC = () => {\r\n    const [state, dispatch] = useReducer(reducer, INITIAL_STATE, (s: State): State => {\r\n        const characters = loadCharacters();\r\n        const selectedCharacterKey = loadSelectedCharacter();\r\n        let selectedCharacter = s.selectedCharacter;\r\n        if (selectedCharacterKey > -1) {\r\n            const selectedCharacterRef = characters.find(c => c.key === selectedCharacterKey);\r\n            if (selectedCharacterRef) {\r\n                const loadedCharacter = loadCharacter(selectedCharacterRef.key);\r\n                if (loadedCharacter) {\r\n                    selectedCharacter = loadedCharacter;\r\n                }\r\n            }\r\n        }\r\n        return { ...s, characters, selectedCharacter };\r\n    });\r\n\r\n    return (\r\n        <DispatchContext.Provider value={dispatch}>\r\n            <StateContext.Provider value={state}>\r\n                <ThemeProvider theme={theme}>\r\n                    <CssBaseline />\r\n                    <CharacterCreator />\r\n                </ThemeProvider>\r\n            </StateContext.Provider>\r\n        </DispatchContext.Provider>\r\n    );\r\n};\r\n\r\nexport default App;","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"root\"));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}